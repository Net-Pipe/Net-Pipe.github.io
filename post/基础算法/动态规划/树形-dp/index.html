<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>树形 DP &#8211; NetPipe&#39;s Blog</title>

  
  <meta name="description" content="简介 ¶树形 DP 以树形结构为研究对象.">
  
  <meta name="author" content="Net Pipe">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="NetPipe&#39;s Blog" />
  <link rel="shortcut icon" type="image/x-icon" href="../../../../images/NetPipe.png" />

  
    <style>@font-face {
  font-family: 'Fantasque Sans Mono';
  src: url("/fonts/FantasqueSansMono-Regular.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: normal;
  font-weight: bold;
  src: url("/fonts/FantasqueSansMono-Bold.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: italic;
  src: url("/fonts/FantasqueSansMono-Italic.woff2") format("woff2"); }

@font-face {
  font-family: 'Lazy';
  src: url("/fonts/lazy.ttf") format("truetype"); }

@font-face {
  font-family: 'Material Icons';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Outlined';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Outlined.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Round';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Round.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Sharp';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Sharp.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Two Tone';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Two Tone.woff2") format("woff2"); }

.material-icons {
  font-family: 'Material Icons';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-outlined {
  font-family: 'Material Icons Outlined';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-round {
  font-family: 'Material Icons Round';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-sharp {
  font-family: 'Material Icons Sharp';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-two-tone {
  font-family: 'Material Icons Two Tone';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

body,
code,
input {
  font-family: 'Fantasque Sans Mono', sans-serif;
  -webkit-font-smoothing: antialiased; }
  body article h1, body article h2, body article h3, body article h4, body article h5, body article h6, body .posts h1, body .posts h2, body .posts h3, body .posts h4, body .posts h5, body .posts h6,
  code article h1,
  code article h2,
  code article h3,
  code article h4,
  code article h5,
  code article h6,
  code .posts h1,
  code .posts h2,
  code .posts h3,
  code .posts h4,
  code .posts h5,
  code .posts h6,
  input article h1,
  input article h2,
  input article h3,
  input article h4,
  input article h5,
  input article h6,
  input .posts h1,
  input .posts h2,
  input .posts h3,
  input .posts h4,
  input .posts h5,
  input .posts h6 {
    font-weight: normal; }

strong {
  font-weight: normal;
  text-shadow: 0 0; }

* {
  margin: 0;
  padding: 0;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  --aside-width: 18rem;
  --box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.1);
  --box-shadow-hover: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  --color: black;
  --border: 1px solid #dee0e2;
  --border-color: #dee0e2;
  --radius: 0.25rem;
  --link-color: #4588be;
  --category-color: rgba(38, 152, 190, 0.7);
  --background-color: white;
  --hover-color: #f7f7f7; }
  * body {
    background-color: #f7f7f7; }

::selection {
  background-color: #CCE2FF;
  color: rgba(0, 0, 0, 0.87); }

::-webkit-scrollbar {
  width: 7px;
  height: 7px; }

::-webkit-scrollbar-thumb {
  border-radius: 10px;
  background: #dddddd; }
  ::-webkit-scrollbar-thumb:hover {
    background: #acacac; }

::-webkit-scrollbar-track {
  border-radius: 10px;
  background: #f0f0f0; }

a {
  text-decoration: none;
  color: #4794d3; }

a:focus, a:hover {
  outline: none;
  text-decoration: underline; }

a.alternate:focus,
a.alternate:hover,
a.alternate:focus > *,
a.alternate:hover > * {
  text-decoration: none;
  background: var(--hover-color); }

small {
  font-size: 70%; }

ol, ul {
  margin: .5rem 0;
  padding-left: 2rem;
  word-break: break-word; }
  ol > li, ul > li {
    margin: .5rem 0; }

ul > li {
  list-style: circle; }

.result {
  width: 100%; }
  .result :first-child .post {
    margin-top: 0; }
  .result :last-child .post {
    margin-bottom: 0; }

.flex-left,
.flex-right {
  flex: 0 0 var(--aside-width); }
  .flex-left div.outer,
  .flex-right div.outer {
    padding: .7rem;
    margin: .3rem;
    width: calc(var(--aside-width) - 2rem);
    height: calc(100% - 2rem);
    position: fixed;
    overflow: auto; }
    .flex-left div.outer::-webkit-scrollbar-track,
    .flex-right div.outer::-webkit-scrollbar-track {
      margin: .7rem; }
  .flex-left div.inner,
  .flex-right div.inner {
    direction: ltr;
    background-color: var(--background-color);
    color: var(--color);
    border-radius: var(--radius);
    box-shadow: var(--box-shadow);
    box-sizing: border-box;
    width: calc(var(--aside-width) - 2rem);
    padding: .5rem;
    margin-bottom: 1rem;
    overflow: auto;
    padding: 1rem; }
    .flex-left div.inner:hover,
    .flex-right div.inner:hover {
      box-shadow: var(--box-shadow-hover); }
    .flex-left div.inner h2,
    .flex-right div.inner h2 {
      margin: 0 0 .5rem 0;
      line-height: 20px; }
      .flex-left div.inner h2 > img,
      .flex-right div.inner h2 > img {
        vertical-align: -2px;
        width: 20px;
        height: 20px;
        margin-right: .5rem; }
    .flex-left div.inner ul,
    .flex-right div.inner ul {
      padding-left: 1rem; }
    .flex-left div.inner:last-of-type,
    .flex-right div.inner:last-of-type {
      margin-bottom: 0; }
  .flex-left div.avatar,
  .flex-right div.avatar {
    text-align: center; }
    .flex-left div.avatar h2,
    .flex-right div.avatar h2 {
      margin: 1rem; }
    .flex-left div.avatar img.avatar,
    .flex-right div.avatar img.avatar {
      transition: all 0.3s;
      border-radius: 1rem;
      box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.2); }
      .flex-left div.avatar img.avatar:hover,
      .flex-right div.avatar img.avatar:hover {
        transform: perspective(1px) scale(1.04); }
    .flex-left div.avatar .data-left,
    .flex-left div.avatar .data-right,
    .flex-right div.avatar .data-left,
    .flex-right div.avatar .data-right {
      flex: 0 0 50%;
      display: inline-block;
      width: calc(50% - 1rem); }
    .flex-left div.avatar .data-left,
    .flex-right div.avatar .data-left {
      border-right: 1px solid var(--color); }
    .flex-left div.avatar .social,
    .flex-right div.avatar .social {
      margin-top: 1rem; }
      .flex-left div.avatar .social .social-box,
      .flex-right div.avatar .social .social-box {
        border-radius: var(--radius);
        box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.2);
        background-color: var(--background-color);
        color: var(--color);
        transition: all 0.3s;
        margin-top: .5rem;
        padding: .5rem;
        text-align: left;
        font-size: 18px; }
        .flex-left div.avatar .social .social-box a,
        .flex-right div.avatar .social .social-box a {
          color: var(--color); }
        .flex-left div.avatar .social .social-box:hover a,
        .flex-right div.avatar .social .social-box:hover a {
          color: var(--link-color);
          text-decoration: underline; }
        .flex-left div.avatar .social .social-box:hover,
        .flex-right div.avatar .social .social-box:hover {
          transform: perspective(1px) scale(1.04); }
        .flex-left div.avatar .social .social-box img,
        .flex-right div.avatar .social .social-box img {
          vertical-align: text-bottom;
          width: 20px; }
        .flex-left div.avatar .social .social-box .search,
        .flex-right div.avatar .social .social-box .search {
          display: inline-block;
          width: calc(100% - 36px); }
          .flex-left div.avatar .social .social-box .search > input,
          .flex-right div.avatar .social .social-box .search > input {
            background-color: var(--background-color);
            color: var(--color);
            border: none;
            font-size: 17px;
            outline: none;
            width: 100%; }
  .flex-left div.categories .post-categories,
  .flex-right div.categories .post-categories {
    display: inline-block;
    transition: all 0.05s;
    line-height: 1.7rem; }
    .flex-left div.categories .post-categories:hover,
    .flex-right div.categories .post-categories:hover {
      transform: perspective(1px) scale(1.04); }
  .flex-left #TableOfContents > ul,
  .flex-right #TableOfContents > ul {
    padding-left: 0;
    margin-bottom: -.5rem; }
    .flex-left #TableOfContents > ul li,
    .flex-right #TableOfContents > ul li {
      list-style: none; }

.flex-left {
  margin-right: -1rem; }

.flex-right {
  margin-left: -1rem; }

.flex-hidden {
  display: none; }

.pagination {
  margin: 0;
  padding: 0;
  width: 100%;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: center;
  font-size: 18px; }
  .pagination div.pagination-box {
    border-radius: var(--radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color);
    margin: 0 .5rem;
    color: var(--link-color);
    width: 2rem;
    height: 2rem;
    line-height: 2rem;
    float: left;
    text-align: center;
    vertical-align: middle;
    cursor: default; }
    .pagination div.pagination-box:hover {
      box-shadow: var(--box-shadow-hover); }
    .pagination div.pagination-box:not(.disabled):hover {
      background-color: var(--hover-color);
      cursor: pointer; }
  .pagination div.prev {
    width: 5rem;
    margin-left: 0; }
  .pagination div.next {
    width: 5rem;
    margin-right: 0; }
  .pagination div.pagination-eldivpsis {
    width: 3rem; }
  .pagination div.disabled {
    color: var(--color); }

.posts .post {
  border-radius: var(--radius);
  box-shadow: var(--box-shadow);
  background-color: var(--background-color);
  color: var(--color);
  margin: 1rem 0;
  padding: .7rem 1rem; }
  .posts .post:hover {
    box-shadow: var(--box-shadow-hover); }

.posts :first-child .post {
  margin-top: 0; }

.post-list {
  border: var(--border);
  border-radius: var(--radius);
  border-radius: var(--radius);
  box-shadow: var(--box-shadow); }
  .post-list:hover {
    box-shadow: var(--box-shadow-hover); }
  .post-list .post-item {
    padding: .3rem .5rem;
    height: 1.5rem; }
    .post-list .post-item * {
      font-size: 100%;
      vertical-align: bottom; }
    .post-list .post-item:hover a {
      color: var(--link-color);
      text-decoration: underline; }

.post-link {
  color: var(--color); }
  .post-link:hover .post-title a {
    color: var(--link-color);
    text-decoration: underline; }

.post-title {
  margin: 0 0 .5rem 0;
  font-size: 20px; }
  .post-title a {
    color: var(--color); }
  .post-title:hover a {
    color: var(--link-color);
    text-decoration: underline; }

.post-meta {
  color: gray; }
  .post-meta img {
    vertical-align: text-bottom; }

.post-categories {
  font-size: 13px; }
  .post-categories a {
    color: white;
    background-color: var(--category-color);
    border-radius: .2rem;
    padding: .2rem .2rem;
    white-space: nowrap; }

.post-summary {
  margin-top: .5rem; }

.post-header {
  margin-bottom: 1rem; }

.post-content {
  text-align: justify;
  background-color: white;
  padding: 1rem; }
  .post-content .md__image {
    display: block;
    max-width: 100%;
    margin: auto; }

.post-content > :first-child, .post-content > :first-child > :first-child, .post-content > :first-child > :first-child > :first-child,
.markdown-inner > :first-child,
.markdown-inner > :first-child > :first-child,
.markdown-inner > :first-child > :first-child > :first-child {
  margin-top: 0; }

.post-content > :last-child, .post-content > :last-child > :last-child, .post-content > :last-child > :last-child > :last-child,
.markdown-inner > :last-child,
.markdown-inner > :last-child > :last-child,
.markdown-inner > :last-child > :last-child > :last-child {
  margin-bottom: 0; }

.post-content ul,
.markdown-inner ul {
  padding-left: 1rem; }

body {
  max-width: 75rem;
  margin: 0 auto;
  overflow: hidden scroll; }

main {
  display: flex; }

article {
  overflow: hidden;
  will-change: transform; }

.blog-page {
  flex-grow: 1;
  min-width: 18rem;
  padding: 1rem;
  width: calc(100% - 42rem); }
  .blog-page .post-toc {
    display: none; }
  .blog-page .post-pagination {
    width: 100%;
    height: 2rem; }
  .blog-page .post-content {
    border-radius: var(--radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color); }
    .blog-page .post-content:hover {
      box-shadow: var(--box-shadow-hover); }

@media screen and (max-width: 70rem) {
  .flex-left .flex-visible {
    margin-bottom: 1rem; }
  .flex-left .flex-hidden {
    display: block; }
  .flex-right {
    display: none; } }

@media screen and (max-width: 48rem) {
  main {
    display: block; }
  .flex-left {
    width: 100%;
    margin: 0;
    margin-bottom: -1rem; }
    .flex-left div.outer {
      position: relative;
      width: auto; }
    .flex-left div.inner {
      width: auto; }
  .blog-page {
    width: calc(100% - 2rem); } }

@media screen and (max-width: 25rem) {
  .pagination div.pagination-box {
    margin: 0 .25rem; } }

.book-columns {
  display: flex;
  flex-wrap: wrap;
  margin: .5rem;
  margin-left: -.5rem;
  margin-right: -.5rem; }
  .book-columns .markdown-inner {
    margin: .5rem;
    flex: 1 1; }

.book-tabs {
  border: var(--border);
  border-radius: var(--radius);
  border-radius: var(--radius);
  box-shadow: var(--box-shadow);
  margin: .5em 0;
  overflow: hidden;
  display: flex;
  flex-wrap: wrap; }
  .book-tabs:hover {
    box-shadow: var(--box-shadow-hover); }
  .book-tabs label {
    line-height: 1rem;
    display: inline-block;
    padding: .3rem 16px;
    cursor: pointer;
    z-index: 999;
    border: 1px solid transparent;
    vertical-align: baseline; }
  .book-tabs .book-tabs-content {
    border-top: var(--border);
    padding: .5rem;
    order: 999;
    width: 100%;
    display: none;
    overflow: hidden;
    border-bottom-left-radius: var(--radius);
    border-bottom-right-radius: var(--radius); }
    .book-tabs .book-tabs-content > :first-child, .book-tabs .book-tabs-content > :first-child > :first-child, .book-tabs .book-tabs-content > :first-child > :first-child > :first-child {
      margin-top: 0; }
    .book-tabs .book-tabs-content > :last-child, .book-tabs .book-tabs-content > :last-child > :last-child, .book-tabs .book-tabs-content > :last-child > :last-child > :last-child {
      margin-bottom: 0; }
    .book-tabs .book-tabs-content ul {
      padding-left: 1rem; }
  .book-tabs input[type="radio"] {
    display: none; }
    .book-tabs input[type="radio"]:not(:checked) + label {
      color: #95A5A6; }
      .book-tabs input[type="radio"]:not(:checked) + label:hover {
        background-color: var(--hover-color); }
    .book-tabs input[type="radio"]:checked + label {
      border-bottom: none; }
      .book-tabs input[type="radio"]:checked + label + .book-tabs-content {
        display: block; }

details {
  border: var(--border);
  border-radius: var(--radius);
  border-radius: var(--radius);
  box-shadow: var(--box-shadow);
  margin: .5rem 0;
  padding: .5rem  1rem .5rem  0.75rem; }
  details:hover {
    box-shadow: var(--box-shadow-hover); }
  details summary {
    font-size: 14px;
    text-shadow: 0 0; }
    details summary::marker {
      content: '';
      font-size: 0; }
  details ::-webkit-details-marker,
  details ::-moz-list-bullet {
    content: '';
    font-size: 0; }
  details label {
    font-size: 20px !important;
    margin-left: -5px;
    margin-right: 5px;
    vertical-align: -4.5px;
    transition: all .3s; }
  details[open] > summary {
    margin-bottom: 0; }
    details[open] > summary label {
      transform: rotate(90deg); }
  details .markdown-inner {
    padding: .5rem 0; }
  details:focus {
    outline: none; }

article h1 {
  font-size: 200%;
  line-height: 110%; }

article h2 {
  font-size: 140%;
  line-height: 120%; }

article h3 {
  font-size: 120%;
  line-height: 120%; }
  article h3 .katex {
    font-size: 100%; }

article h4 {
  font-size: 110%; }

article p {
  margin: .5rem 0;
  line-height: 1.5rem; }

article h1, article h2, article h3, article h4, article h5, article h6 {
  margin: .7rem 0; }
  article h1 .anchor, article h2 .anchor, article h3 .anchor, article h4 .anchor, article h5 .anchor, article h6 .anchor {
    opacity: 0; }
  article h1:hover .anchor, article h1:focus .anchor, article h2:hover .anchor, article h2:focus .anchor, article h3:hover .anchor, article h3:focus .anchor, article h4:hover .anchor, article h4:focus .anchor, article h5:hover .anchor, article h5:focus .anchor, article h6:hover .anchor, article h6:focus .anchor {
    opacity: 1; }

article hr {
  border: none;
  border-bottom: 1px solid #ebeced; }

article blockquote {
  border: var(--border);
  border-radius: none;
  border-radius: var(--radius);
  box-shadow: var(--box-shadow);
  border-left: .3rem solid lightgray;
  padding: .2rem .5rem; }
  article blockquote:hover {
    box-shadow: var(--box-shadow-hover); }
  article blockquote > :first-child, article blockquote > :first-child > :first-child, article blockquote > :first-child > :first-child > :first-child {
    margin-top: 0; }
  article blockquote > :last-child, article blockquote > :last-child > :last-child, article blockquote > :last-child > :last-child > :last-child {
    margin-bottom: 0; }
  article blockquote ul {
    padding-left: 1rem; }

article pre {
  border: var(--border);
  border-radius: var(--radius);
  border-radius: var(--radius);
  box-shadow: var(--box-shadow);
  margin: .5rem 0;
  padding: .5rem 1rem;
  overflow-x: auto;
  line-height: 22px; }
  article pre:hover {
    box-shadow: var(--box-shadow-hover); }

article code {
  border: var(--border);
  border-radius: var(--radius);
  padding: 1px 2px; }

article pre {
  color: #686868; }
  article pre code {
    border: none;
    padding: 0; }
  article pre * {
    user-select: text;
    -moz-user-select: text;
    -webkit-user-select: text; }

article code:focus {
  outline: none; }

article .md__table {
  padding: .5rem;
  margin: -.5rem !important;
  overflow: auto; }
  article .md__table::-webkit-scrollbar-track {
    margin: .5rem; }
  article .md__table table {
    border: var(--border);
    border-radius: var(--radius);
    border-radius: var(--radius);
    box-shadow: var(--box-shadow);
    border-spacing: 0;
    overflow: auto;
    -webkit-overflow-scrolling: touch; }
    article .md__table table:hover {
      box-shadow: var(--box-shadow-hover); }
    article .md__table table th {
      font-weight: normal; }
    article .md__table table td {
      border-top: 1px solid var(--border-color); }
    article .md__table table th, article .md__table table td {
      padding: .3rem 16px;
      white-space: nowrap; }

article .mermaid svg {
  display: block;
  margin: auto;
  zoom: 80%; }
</style>
  
</head>






<body>
<main>
  <div class="flex-left">
    <div class="outer">
      <div class="flex-visible">
        
  <div class="inner avatar">
  <a href="../../../../"><img src="../../../../images/NetPipe.png" class="avatar" width="96px" height="96px" /></a>
  <h2>Net Pipe</h2>
  <div class="data-left">
    <h3>59</h3>
    <span>Posts</span>
  </div>
  <div class="data-right">
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    <h3>18778</h3>
    <span>Words</span>
  </div>
  <div class="social">
    <div class="social-box">
      <img src="../../../../images/search.svg"/>
      <div class="search">
        <input type="text" placeholder="Search" id="search-key" maxlength="64" data-hotkeys="s/" onkeydown="keyup_submit(event);" />
      </div>
    </div>
    <a class="alternate" href="../../../../">
      <div class="social-box">
        <img src="../../../../images/home.svg"/>
        <object><a href="../../../../">Home</a></object>
      </div>
    </a>
    <a class="alternate" href="../../../../post/">
      <div class="social-box">
        <img src="../../../../images/posts.svg"/>
        <object><a href="../../../../post/">Posts</a></object>
      </div>
    </a>
    <a class="alternate" type="application/rss+xml" href="../../../../index.xml">
      <div class="social-box">
        <img src="../../../../images/rss.svg"/>
        <object><a  type="application/rss+xml" href="../../../../index.xml">RSS</a></object>
      </div>
    </a>
  </div>
  <script>
    function keyup_submit(e){ 
    var evt = window.event || e; 
      if (evt.keyCode == 13){
        window.location.href = '/_search?wd=' + document.getElementById("search-key").value;
      }
    }
  </script>
</div>
  <div class="inner categories">
  <h2><img src="../../../../images/categories.svg" />Categories</h2>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%9F%BA%E7%A1%80%E6%95%B0%E5%AD%A6/">基础数学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/dp/">DP</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E4%BF%A1%E6%81%AF%E5%AD%A6/">信息学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E6%95%B0%E8%AE%BA/">数论</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">组合数学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%9B%BE%E8%AE%BA/">图论</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/">字符串</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/">基础算法</a>
  </span>
  
</div>

      </div>
      <div class="flex-hidden">
        
  <div class="inner">
  <h2><img src="../../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a></li>
    <li><a href="#例-1">例 1</a></li>
    <li><a href="#例-2">例 2</a></li>
    <li><a href="#树形-dp--背包-dp">树形 DP + 背包 DP</a></li>
  </ul>
</nav>
</div>



      </div>
    </div>
  </div>

  
<div class="blog-page">
  <article class="post-content">
    
    <div class="post-header">
      <h1>树形 DP</h1>
      <span class="post-meta">
        
          <img src="../../../../images/time.svg"></img>
          Apr 1, 2021
        
      </span>
      <span class="post-categories">
        
          <a href="../../../../categories/%e4%bf%a1%e6%81%af%e5%ad%a6/">信息学</a>
        
          <a href="../../../../categories/dp/">DP</a>
        
      </span>
    </div>
    
    <h2 id="简介">简介 <a class="anchor" href="#%e7%ae%80%e4%bb%8b">¶</a></h2><p><strong>树形 DP</strong> 以树形结构为研究对象. 通常设 $f[u]$ 为树中 $u$ 号节点的值，利用树形关系推出其它节点的值. DP 过程多为 <a href="../../../../posts/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E8%AE%B0%E5%BF%86%E5%8C%96%E6%90%9C%E7%B4%A2/">记忆化搜索</a>.</p>
<h2 id="例-1">例 1 <a class="anchor" href="#%e4%be%8b-1">¶</a></h2><p>给定一棵 $n$ 个点，$m$ 条边的树，顶点编号为 $1\sim n$，且以 $1$ 号节点为根. 以 $i$ 号节点为根的子树有几个节点？</p>
<p>$f[i]$：以 $i$ 号节点为根的子树的节点数.</p>
<p>$Son[i]$：$i$ 号节点的子节点集合.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-latex" data-lang="latex">f[i]=1+<span style="color:#728e00">\sum</span><span style="color:#728e00">_{</span>v<span style="color:#728e00">\in</span> Son[i]<span style="color:#728e00">}</span>f[v]
</code></pre></div><p>计算顺序为 $f[$子节点$]→f[$父节点$]$. 使用记忆化搜索.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">son</span>[]; <span style="color:#95a5a6">// son[u] : 节点 u 的子节点集合
</span><span style="color:#95a5a6"></span>
<span style="color:#00979d">void</span> <span style="color:#d35400">dfs</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) { <span style="color:#95a5a6">// 求以 u 为根的子树中节点个数
</span><span style="color:#95a5a6"></span>    <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>;
    <span style="color:#728e00">for</span> (<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">son</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">son</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>]; <span style="color:#95a5a6">// 节点 u 的第 i 个子节点
</span><span style="color:#95a5a6"></span>        <span style="color:#434f54">dfs</span>(<span style="color:#434f54">v</span>);
        <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">+=</span> <span style="color:#434f54">f</span>[<span style="color:#434f54">v</span>];
    }
}
</code></pre></div><h2 id="例-2">例 2 <a class="anchor" href="#%e4%be%8b-2">¶</a></h2><p>公司有 $n$ 个人，编号为 $1\cdots n$，其中 $1$ 号员工是 boss. 现要举⾏⼀场晚会，如果邀请了某个⼈，那么他的上司不会来（他上司的上司，上司的上司的上司 $\cdots$ 都可以来）.</p>
<p>每个⼈都有⼀个欢乐值，给出公司所有人的上下级关系，求⼀个邀请⽅案，使欢乐值的和最⼤.</p>
<p>$f[i,j]$：从员工 $i$ 和所有下属中邀请部分人参会的最大欢乐值. 当 $j=0$ 时 $i$ 号员工不参会，$j=1$ 时参会.</p>
<p>$Son[i]$：员工 $i$ 的下属集合.</p>
<ul>
<li>若 $i$ 号员工参会，他的直接下属都不来：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-latex" data-lang="latex">f[i,1]=H<span style="color:#728e00">_</span>i+<span style="color:#728e00">\sum</span><span style="color:#728e00">_{</span>v<span style="color:#728e00">\in</span> Son(i)<span style="color:#728e00">}</span>f[v,0]
</code></pre></div><ul>
<li>若 $i$ 号员工参会，他的直接下属爱来不来，于是取最大值：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-latex" data-lang="latex">f[i,0]=<span style="color:#728e00">\sum</span><span style="color:#728e00">_{</span>v<span style="color:#728e00">\in</span> Son(i)<span style="color:#728e00">}</span><span style="color:#728e00">\max\{</span>f[v,0],f[v,1]<span style="color:#728e00">\}</span>
</code></pre></div><p>时间复杂度为 $O(n)$，最终答案为 $\max\{f[1,0],f[1,1]\}$.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">son</span>[]; <span style="color:#95a5a6">// son[u] : 员工 u 的下属集合
</span><span style="color:#95a5a6"></span>
<span style="color:#00979d">void</span> <span style="color:#d35400">dfs</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) { <span style="color:#95a5a6">// 求出 u 号员工对应的 f[u][0] 和 f[u][1]
</span><span style="color:#95a5a6"></span>    <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>][<span style="color:#8a7b52">1</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">h</span>[<span style="color:#434f54">u</span>];
    <span style="color:#728e00">for</span> (<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">son</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">son</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>]; <span style="color:#95a5a6">// 员工 u 的第 i 个下属
</span><span style="color:#95a5a6"></span>        <span style="color:#434f54">dfs</span>(<span style="color:#434f54">v</span>);
        <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>][<span style="color:#8a7b52">1</span>] <span style="color:#728e00">+=</span> <span style="color:#434f54">f</span>[<span style="color:#434f54">v</span>][<span style="color:#8a7b52">0</span>];
        <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>][<span style="color:#8a7b52">0</span>] <span style="color:#728e00">+=</span> <span style="color:#434f54">max</span>(<span style="color:#434f54">f</span>[<span style="color:#434f54">v</span>][<span style="color:#8a7b52">0</span>], <span style="color:#434f54">f</span>[<span style="color:#434f54">v</span>][<span style="color:#8a7b52">1</span>]);
    }
}
</code></pre></div><h2 id="树形-dp--背包-dp">树形 DP + 背包 DP <a class="anchor" href="#%e6%a0%91%e5%bd%a2-dp--%e8%83%8c%e5%8c%85-dp">¶</a></h2><p>处理某些问题时，需要结合树形 DP 和背包 DP 的思想.</p>
<p>现有 $n$ 门课程，第 $i$ 门课程的学分为 $s_i$，每门课程有 $0$ 或 $1$ 门先修课.有先修课的课程需要先学完先修课，才能学习该课程.求学习 $m$ 门课程能获得的最多学分.</p>
<p>将每门课程看作树中的节点，$a→b$ 代表 $a$ 比 $b$ 先修：</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart
2--&gt;1
2--&gt;4
2--&gt;7
    7--&gt;5
    7--&gt;6
3
</code></pre><p>为了方便解决问题，新增 $0$ 号节点，使其指向所有无先修课的课程：</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart
0--&gt;2
0--&gt;3
    2--&gt;1
    2--&gt;4
    2--&gt;7
        7--&gt;5
        7--&gt;6
    3
</code></pre><p>$f[u,j]$ 表示以 $u$ 为根节点，选 $j$ 个节点，获得的最大学分.</p>
<p>$dfs(u)$ 的功能是算出以 $u$ 为根节点时，分别选 $0\sim m$ 个节点时能获得的最大学分.</p>
<p>执行 $dfs(u)$ 时，枚举 $u$ 的子节点 $v$，在内层循环枚举选取的节点数 $j=m→1$：</p>
<ul>
<li>
<p>将 $j$ 个节点分成两组，一组 $k$ 个，另一组 $j-k$ 个；</p>
</li>
<li>
<p>将第一组 $k$ 个节点放在以 $v$ 为根节点的子树中，最大学分为 $f[v][k]$；</p>
</li>
<li>
<p>将第二组 $j-k$ 个节点放在以 $u$ 为根节点的子树中，但不放在以 $v$ 为根节点的子树中，最大学分为 $f[u][j-k]$.</p>
</li>
</ul>
<p>$$f[u,j]=\max_{v\in Son(u)}{f[u,j],f[u,j-k]+f[v,k]}$$</p>
<table>
<thead>
<tr>
<th style="text-align:center">初始条件</th>
<th style="text-align:center">$f[i,1]=s[i]$</th>
<th style="text-align:center">边界条件</th>
<th style="text-align:center">$f[0,m]$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">时间复杂度</td>
<td style="text-align:center">$O(n^3)$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
<p>在主程序中执行 $dfs(0)$ 后输出 $f[0,m]$ 即可.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00979d">void</span> <span style="color:#d35400">dfs</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>][<span style="color:#8a7b52">1</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">s</span>[<span style="color:#434f54">u</span>];
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">son</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">son</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>];
        <span style="color:#434f54">dfs</span>(<span style="color:#434f54">v</span>);
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#434f54">m</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&gt;=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">--</span>)
            <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">k</span> <span style="color:#728e00">=</span> <span style="color:#434f54">j</span> <span style="color:#728e00">-</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">k</span> <span style="color:#728e00">&gt;</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">k</span> <span style="color:#728e00">--</span>)
                <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">j</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">max</span>(<span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">j</span>], <span style="color:#434f54">f</span>[<span style="color:#434f54">v</span>][<span style="color:#434f54">k</span>] <span style="color:#728e00">+</span> <span style="color:#434f54">f</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">j</span> <span style="color:#728e00">-</span> <span style="color:#434f54">k</span>]);
    }
}
</code></pre></div>
  </article>
</div>



  <div class="flex-right">
    <div class="outer">
      
  <div class="inner">
  <h2><img src="../../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a></li>
    <li><a href="#例-1">例 1</a></li>
    <li><a href="#例-2">例 2</a></li>
    <li><a href="#树形-dp--背包-dp">树形 DP + 背包 DP</a></li>
  </ul>
</nav>
</div>



    </div>
  </div>

  <script src="../../../../js/jquery.min.js"></script>


<script defer>
function IsPC() {  
  var userAgentInfo = navigator.userAgent;
  var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");  
  for (var v = 0; v < Agents.length; v ++) {  
    if (userAgentInfo.indexOf(Agents[v]) > 0) {
      return false;
    }
  }
  return true;
}
function detectZoom() {
  var ratio = 0,
  screen = window.screen,
  ua = navigator.userAgent.toLowerCase();
  if (window.devicePixelRatio !== undefined)
    ratio = window.devicePixelRatio;
  else if (~ua.indexOf('msie')) {
    if (screen.deviceXDPI && screen.logicalXDPI)
      ratio = screen.deviceXDPI / screen.logicalXDPI;
  }
  else if (window.outerWidth !== undefined && window.innerWidth !== undefined)
    ratio = window.outerWidth / window.innerWidth;
  
  if (ratio)
    ratio = Math.round(ratio * 100);
  return ratio;
}
$('img').each(function(id, el, arr) {
  if (el.parentElement.tagName == 'P') {
    el.className = "md__image";
    var src = el.getAttribute('src');
    if (IsPC() && src.substr(src.lastIndexOf(".") + 1) != "svg") {
      if (el.style.zoom)
        el.style.zoom = parseFloat(el.style.zoom) / detectZoom();
      else
        el.style.zoom = 100 / detectZoom();
    }
  }
});

















</script>





<link rel="stylesheet" href="../../../../katex/katex.min.css">
<script src="../../../../katex/katex.min.js"></script>
<script src="../../../../katex/auto-render.min.js"></script>

<script>
  function renderTex() {
    renderMathInElement(document.body, {
      trust: true,
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ],
      macros: {
        
        "\\d": "\\text{d}",
        "\\zh": "\\footnotesize \\ ",
        "\\en": "\\normalsize \\ ",
        "\\su": "\\displaystyle",
        "\\eq": "\\Longleftrightarrow",
        "\\intro": "\\Longrightarrow",
        "\\mathring": "\\overset\{\\normalsizeₒ\}",
        "\\arccot": "\\text\{arccot\} \\, ",
        "\\xor": "\\text\{xor\} \\, ",
        "\\mex": "\\text\{mex\} \\, "
      }
    });
  }  
  document.addEventListener("DOMContentLoaded", function() {
    renderTex();
  });

</script>

<script>
  $('.language-latex').each(function(id, el, arr) {
    function toText(text) { 
      var temp = document.createElement("div"); 
      temp.innerHTML = text; 
      var output = temp.innerText || temp.textContent; 
      temp = null; 
      return output; 
    } 
    tex = toText(el.innerHTML);
    el.parentElement.outerHTML = '<div>$$' + tex + '$$</div>';
  });

</script>

<script>
  $('table').each(function(id, el, arr) {
    el.outerHTML = `<div class="md__table">${el.outerHTML}</div>`;
  });
</script>



<script src="../../../../js/mermaid.min.js"></script>

<script>
  mermaid.initialize({
    
    themeCSS: ".node rect { \
      fill: transparent;    \
      stroke: transparent;  \
    }                       \
    .nodeLabel {            \
      font-size: 24px;      \
    }",
    startOnLoad: true,
    flowchart: {
      curve: 'cardinal'
    },
    securityLevel: 'loose',
  });
</script>

<script>
  Array.from(document.getElementsByClassName("language-mermaid")).forEach(
    (el) => {
      el.parentElement.outerHTML = `<div class="mermaid">${el.innerText}</div>`;
    }
  );
</script>

  
</main>
</body>
</html>