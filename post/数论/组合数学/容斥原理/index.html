<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>容斥原理 &#8211; NetPipe&#39;s Blog</title>

  
  <meta name="description" content="注意：若无特殊说明，本章涉及的变量皆为正整数.">
  
  <meta name="author" content="Net Pipe">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="NetPipe&#39;s Blog" />
  <link rel="shortcut icon" type="image/x-icon" href="../../../../images/freeze.png" />

  
    <style>@font-face {
  font-family: 'Fantasque Sans Mono';
  src: url("/fonts/FantasqueSansMono-Regular.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: normal;
  font-weight: bold;
  src: url("/fonts/FantasqueSansMono-Bold.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: italic;
  src: url("/fonts/FantasqueSansMono-Italic.woff2") format("woff2"); }

@font-face {
  font-family: 'Lazy';
  src: url("/fonts/lazy.ttf") format("truetype"); }

@font-face {
  font-family: 'Material Icons';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Outlined';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Outlined.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Round';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Round.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Sharp';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Sharp.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Two Tone';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Two Tone.woff2") format("woff2"); }

.material-icons {
  font-family: 'Material Icons';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-outlined {
  font-family: 'Material Icons Outlined';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-round {
  font-family: 'Material Icons Round';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-sharp {
  font-family: 'Material Icons Sharp';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-two-tone {
  font-family: 'Material Icons Two Tone';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

body,
code,
input {
  font-family: 'Fantasque Sans Mono', sans-serif;
  -webkit-font-smoothing: antialiased; }
  body article h1, body article h2, body article h3, body article h4, body article h5, body article h6, body .posts h1, body .posts h2, body .posts h3, body .posts h4, body .posts h5, body .posts h6,
  code article h1,
  code article h2,
  code article h3,
  code article h4,
  code article h5,
  code article h6,
  code .posts h1,
  code .posts h2,
  code .posts h3,
  code .posts h4,
  code .posts h5,
  code .posts h6,
  input article h1,
  input article h2,
  input article h3,
  input article h4,
  input article h5,
  input article h6,
  input .posts h1,
  input .posts h2,
  input .posts h3,
  input .posts h4,
  input .posts h5,
  input .posts h6 {
    font-weight: normal; }

strong {
  font-weight: normal;
  text-shadow: 0 0; }

* {
  margin: 0;
  padding: 0;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  --aside-width: 18rem;
  --box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.1);
  --box-shadow-hover: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  --color: black;
  --border: 1px solid #dee0e2;
  --border-color: #dee0e2;
  --border-radius: 0.25rem;
  --link-color: #4588be;
  --category-color: rgba(72, 175, 209, 0.7);
  --background-color: white;
  --hover-color: #f7f7f7; }
  * body {
    background-color: #f7f7f7; }

::selection {
  background-color: #CCE2FF;
  color: rgba(0, 0, 0, 0.87); }

::-webkit-scrollbar {
  width: 7px;
  height: 7px; }

::-webkit-scrollbar-thumb {
  border-radius: 10px;
  background: #dddddd; }
  ::-webkit-scrollbar-thumb:hover {
    background: #acacac; }

::-webkit-scrollbar-track {
  border-radius: 10px;
  background: #f0f0f0; }

a {
  text-decoration: none;
  color: #4794d3; }

a:focus, a:hover {
  outline: none;
  text-decoration: underline; }

a.alternate:focus,
a.alternate:hover,
a.alternate:focus > *,
a.alternate:hover > * {
  text-decoration: none;
  background: var(--hover-color); }

small {
  font-size: 70%; }

ol, ul {
  margin: .5rem 0;
  padding-left: 2rem;
  word-break: break-word; }
  ol > li, ul > li {
    margin: .5rem 0; }

ul > li {
  list-style: circle; }

.result {
  width: 100%; }
  .result :first-child .post {
    margin-top: 0; }
  .result :last-child .post {
    margin-bottom: 0; }

.pagination {
  margin: 0;
  padding: 0;
  width: 100%;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: center;
  font-size: 18px; }
  .pagination div.pagination-box {
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color);
    margin: 0 .5rem;
    color: var(--link-color);
    width: 2rem;
    height: 2rem;
    line-height: 2rem;
    float: left;
    text-align: center;
    vertical-align: middle;
    cursor: default; }
    .pagination div.pagination-box:hover {
      box-shadow: var(--box-shadow-hover); }
    .pagination div.pagination-box:not(.disabled):hover {
      background-color: var(--hover-color);
      cursor: pointer; }
  .pagination div.prev {
    width: 5rem;
    margin-left: 0; }
  .pagination div.next {
    width: 5rem;
    margin-right: 0; }
  .pagination div.pagination-eldivpsis {
    width: 3rem; }
  .pagination div.disabled {
    color: var(--color); }

.posts .post {
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  background-color: var(--background-color);
  color: var(--color);
  margin: 1rem 0;
  padding: .7rem 1rem; }
  .posts .post:hover {
    box-shadow: var(--box-shadow-hover); }

.posts :first-child .post {
  margin-top: 0; }

.post-list {
  border: var(--border);
  border-radius: var(--border-radius); }
  .post-list .post-item {
    padding: .3rem .5rem;
    height: 1.5rem; }
    .post-list .post-item * {
      font-size: 100%;
      vertical-align: bottom; }
    .post-list .post-item:hover a {
      color: var(--link-color);
      text-decoration: underline; }

.post-link {
  color: var(--color); }
  .post-link:hover .post-title a {
    color: var(--link-color);
    text-decoration: underline; }

.post-title {
  margin: 0 0 .5rem 0;
  font-size: 20px; }
  .post-title a {
    color: var(--color); }
  .post-title:hover a {
    color: var(--link-color);
    text-decoration: underline; }

.post-meta {
  color: gray; }
  .post-meta img {
    vertical-align: text-bottom; }

.post-categories {
  font-size: 13px; }
  .post-categories a {
    color: white;
    background-color: var(--category-color);
    border-radius: .2rem;
    padding: .2rem .2rem;
    white-space: nowrap; }

.post-summary {
  margin-top: .5rem; }

.post-header {
  margin-bottom: 1rem; }

.post-content {
  text-align: justify;
  background-color: white;
  padding: 1rem; }
  .post-content .md__image {
    display: block;
    max-width: 100%;
    margin: auto; }

.post-content > :first-child,
.post-content > :first-child > :first-child,
.post-content > :first-child > :first-child > :first-child,
.markdown-inner > :first-child,
.markdown-inner > :first-child > :first-child,
.markdown-inner > :first-child > :first-child > :first-child {
  margin-top: 0; }

.post-content > :last-child,
.post-content > :last-child > :last-child,
.post-content > :last-child > :last-child > :last-child,
.markdown-inner > :last-child,
.markdown-inner > :last-child > :last-child,
.markdown-inner > :last-child > :last-child > :last-child {
  margin-bottom: 0; }

.flex-left,
.flex-right {
  flex: 0 0 var(--aside-width); }
  .flex-left div.outer,
  .flex-right div.outer {
    padding: .7rem;
    margin: .3rem;
    width: calc(var(--aside-width) - 2rem);
    height: calc(100% - 2rem);
    position: fixed;
    overflow: auto; }
    .flex-left div.outer::-webkit-scrollbar-track,
    .flex-right div.outer::-webkit-scrollbar-track {
      margin: .7rem; }
    .flex-left div.outer div.avatar,
    .flex-right div.outer div.avatar {
      text-align: center; }
      .flex-left div.outer div.avatar h2,
      .flex-right div.outer div.avatar h2 {
        margin: 1rem; }
      .flex-left div.outer div.avatar .data-left,
      .flex-left div.outer div.avatar .data-right,
      .flex-right div.outer div.avatar .data-left,
      .flex-right div.outer div.avatar .data-right {
        flex: 0 0 50%;
        display: inline-block;
        width: calc(50% - 1rem); }
      .flex-left div.outer div.avatar .data-left,
      .flex-right div.outer div.avatar .data-left {
        border-right: 1px solid var(--color); }
      .flex-left div.outer div.avatar .social,
      .flex-right div.outer div.avatar .social {
        margin-top: 1rem; }
        .flex-left div.outer div.avatar .social .social-box,
        .flex-right div.outer div.avatar .social .social-box {
          border-radius: var(--border-radius);
          box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.2);
          transition: all .3s;
          background-color: var(--background-color);
          color: var(--color);
          margin-top: .5rem;
          padding: .5rem;
          text-align: left;
          font-size: 18px; }
          .flex-left div.outer div.avatar .social .social-box:hover,
          .flex-right div.outer div.avatar .social .social-box:hover {
            transform: scale(1.03); }
          .flex-left div.outer div.avatar .social .social-box a,
          .flex-right div.outer div.avatar .social .social-box a {
            color: var(--color); }
          .flex-left div.outer div.avatar .social .social-box:hover a,
          .flex-right div.outer div.avatar .social .social-box:hover a {
            color: var(--link-color);
            text-decoration: underline; }
          .flex-left div.outer div.avatar .social .social-box img,
          .flex-right div.outer div.avatar .social .social-box img {
            vertical-align: text-bottom;
            width: 20px; }
          .flex-left div.outer div.avatar .social .social-box .search,
          .flex-right div.outer div.avatar .social .social-box .search {
            display: inline-block;
            width: calc(100% - 36px); }
            .flex-left div.outer div.avatar .social .social-box .search > input,
            .flex-right div.outer div.avatar .social .social-box .search > input {
              background-color: var(--background-color);
              color: var(--color);
              border: none;
              font-size: 17px;
              outline: none;
              width: 100%; }
    .flex-left div.outer div.categories .post-categories,
    .flex-right div.outer div.categories .post-categories {
      margin: .5rem 0;
      line-height: 1.7rem; }
    .flex-left div.outer #TableOfContents > ul,
    .flex-right div.outer #TableOfContents > ul {
      padding-left: 0;
      margin-bottom: 0; }
      .flex-left div.outer #TableOfContents > ul li,
      .flex-right div.outer #TableOfContents > ul li {
        list-style: none; }
        .flex-left div.outer #TableOfContents > ul li:last-of-type,
        .flex-right div.outer #TableOfContents > ul li:last-of-type {
          margin-bottom: 0; }
  .flex-left div.inner,
  .flex-right div.inner {
    direction: ltr;
    background-color: var(--background-color);
    color: var(--color);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    box-sizing: border-box;
    width: calc(var(--aside-width) - 2rem);
    padding: .5rem;
    margin-bottom: 1rem;
    overflow: auto;
    padding: 1rem; }
    .flex-left div.inner:hover,
    .flex-right div.inner:hover {
      box-shadow: var(--box-shadow-hover); }
    .flex-left div.inner h2,
    .flex-right div.inner h2 {
      margin: 0 0 .5rem 0;
      line-height: 20px; }
      .flex-left div.inner h2 > img,
      .flex-right div.inner h2 > img {
        vertical-align: -2px;
        width: 20px;
        height: 20px;
        margin-right: .5rem; }
    .flex-left div.inner ul,
    .flex-right div.inner ul {
      padding-left: 1rem; }
    .flex-left div.inner:last-of-type,
    .flex-right div.inner:last-of-type {
      margin-bottom: 0; }

.flex-left {
  margin-right: -1rem; }

.flex-right {
  margin-left: -1rem; }

.flex-hidden {
  display: none; }

body {
  max-width: 75rem;
  margin: 0 auto;
  overflow: hidden scroll; }

main {
  display: flex; }

article {
  overflow: hidden;
  will-change: transform; }

.blog-page {
  flex-grow: 1;
  min-width: 18rem;
  padding: 1rem;
  width: calc(100% - 42rem); }
  .blog-page .post-toc {
    display: none; }
  .blog-page .post-pagination {
    width: 100%;
    height: 2rem; }
  .blog-page .post-content {
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color); }
    .blog-page .post-content:hover {
      box-shadow: var(--box-shadow-hover); }

@media screen and (max-width: 70rem) {
  .flex-left .flex-visible {
    margin-bottom: 1rem; }
  .flex-left .flex-hidden {
    display: block; }
  .flex-right {
    display: none; } }

@media screen and (max-width: 48rem) {
  main {
    display: block; }
  .flex-left {
    width: 100%;
    margin: 0;
    margin-bottom: -1rem; }
    .flex-left div.outer {
      position: relative;
      width: auto; }
    .flex-left div.inner {
      width: auto; }
  .blog-page {
    width: calc(100% - 2rem); } }

@media screen and (max-width: 25rem) {
  .pagination div.pagination-box {
    margin: 0 .25rem; } }

.book-columns {
  display: flex;
  flex-wrap: wrap;
  margin: .5rem;
  margin-left: -.5rem;
  margin-right: -.5rem; }
  .book-columns .markdown-inner {
    margin: .5rem;
    flex: 1 1; }

.book-tabs {
  margin: .5em 0;
  overflow: hidden;
  display: flex;
  flex-wrap: wrap; }
  .book-tabs label {
    line-height: 1rem;
    display: inline-block;
    padding: .3rem 16px;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    cursor: pointer;
    z-index: 999;
    border: 1px solid transparent;
    vertical-align: baseline; }
  .book-tabs .book-tabs-content,
  .book-tabs .book-tabs-pure-content {
    order: 999;
    width: 100%;
    display: none;
    overflow: hidden;
    border-bottom-left-radius: var(--border-radius);
    border-bottom-right-radius: var(--border-radius); }
  .book-tabs .book-tabs-content {
    border: var(--border);
    padding: .5rem; }
  .book-tabs input[type="radio"] {
    display: none; }
    .book-tabs input[type="radio"]:not(:checked) + label {
      color: #95A5A6; }
      .book-tabs input[type="radio"]:not(:checked) + label:hover {
        background-color: var(--hover-color); }
    .book-tabs input[type="radio"]:checked + label {
      border: var(--border);
      border-bottom: none; }
      .book-tabs input[type="radio"]:checked + label + .book-tabs-content, .book-tabs input[type="radio"]:checked + label + .book-tabs-pure-content {
        display: block; }
    .book-tabs input[type="radio"]:first-of-type:checked + label + .book-tabs-pure-content :first-child {
      border-top-left-radius: 0; }

details {
  border: var(--border);
  border-radius: var(--border-radius);
  margin: .5rem 0;
  padding: .5rem  1rem .5rem  0.75rem; }
  details summary {
    font-size: 12.8px;
    font-weight: bold; }
    details summary::marker {
      content: '';
      font-size: 0; }
  details ::-webkit-details-marker {
    content: '';
    font-size: 0; }
  details ::-moz-list-bullet {
    content: '';
    font-size: 0; }
  details label {
    font-size: 20px !important;
    margin-left: -5px;
    margin-right: 5px;
    vertical-align: -4.5px; }
  details[open] > summary {
    margin-bottom: 0; }
    details[open] > summary label {
      transform: rotate(90deg); }
  details .markdown-inner {
    padding: .5rem 0; }
  details:focus {
    outline: none; }

article h1 {
  font-size: 200%;
  line-height: 110%; }

article h2 {
  font-size: 140%;
  line-height: 120%; }

article h3 {
  font-size: 120%;
  line-height: 120%; }
  article h3 .katex {
    font-size: 100%; }

article h4 {
  font-size: 110%; }

article p {
  margin: .5rem 0;
  line-height: 1.5rem; }

article h1, article h2, article h3, article h4, article h5, article h6 {
  margin: .7rem 0; }
  article h1 .anchor, article h2 .anchor, article h3 .anchor, article h4 .anchor, article h5 .anchor, article h6 .anchor {
    opacity: 0; }
  article h1:hover .anchor, article h1:focus .anchor, article h2:hover .anchor, article h2:focus .anchor, article h3:hover .anchor, article h3:focus .anchor, article h4:hover .anchor, article h4:focus .anchor, article h5:hover .anchor, article h5:focus .anchor, article h6:hover .anchor, article h6:focus .anchor {
    opacity: 1; }

article hr {
  border: none;
  border-bottom: 1px solid #ebeced; }

article blockquote {
  border: var(--border);
  border-radius: var(--border-radius);
  border-left: .3rem solid lightgray;
  padding: 0 .5rem; }

article pre {
  border: var(--border);
  border-radius: var(--border-radius);
  margin: .5rem 0;
  padding: .5rem 1rem;
  overflow-x: auto;
  line-height: 22px; }

article code {
  border: var(--border);
  border-radius: var(--border-radius);
  padding: 1px 2px; }

article pre {
  color: #686868; }
  article pre code {
    border: none;
    padding: 0; }
  article pre * {
    user-select: text;
    -moz-user-select: text;
    -webkit-user-select: text; }

article code:focus {
  outline: none; }

article .md__table {
  margin: -.5rem;
  padding: .5rem;
  overflow: auto; }
  article .md__table::-webkit-scrollbar-track {
    margin: .5rem; }
  article .md__table table {
    border: var(--border);
    border-radius: var(--border-radius);
    border-spacing: 0;
    overflow: auto;
    -webkit-overflow-scrolling: touch; }
    article .md__table table th {
      font-weight: normal; }
    article .md__table table td {
      border-top: 1px solid var(--border-color); }
    article .md__table table th, article .md__table table td {
      padding: .3rem 16px;
      white-space: nowrap; }

article .mermaid svg {
  display: block;
  margin: auto;
  zoom: 80%; }
</style>
  
</head>






<body>
<main>
  <div class="flex-left">
    <div class="outer">
      <div class="flex-visible">
        
  <div class="inner avatar">
  <img src="../../../../images/freeze.png" class="avatar" width="96px" height="96px" />
  <h2>Net Pipe</h2>
  <div class="data-left">
    <h3>57</h3>
    <span>Posts</span>
  </div>
  <div class="data-right">
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    <h3>18313</h3>
    <span>Words</span>
  </div>
  <div class="social">
    <div class="social-box">
      <img src="../../../../images/search.svg"/>
      <div class="search">
        <input type="text" placeholder="Search" id="search-key" maxlength="64" data-hotkeys="s/" onkeydown="keyup_submit(event);" />
      </div>
    </div>
    <a class="alternate" href="../../../../">
      <div class="social-box">
        <img src="../../../../images/home.svg"/>
        <object><a href="../../../../">Home</a></object>
      </div>
    </a>
    <a class="alternate" href="../../../../post/">
      <div class="social-box">
        <img src="../../../../images/posts.svg"/>
        <object><a href="../../../../post/">Posts</a></object>
      </div>
    </a>
    <a class="alternate" type="application/rss+xml" href="../../../../index.xml">
      <div class="social-box">
        <img src="../../../../images/rss.svg"/>
        <object><a  type="application/rss+xml" href="../../../../index.xml">RSS</a></object>
      </div>
    </a>
  </div>
  <script>
    function keyup_submit(e){ 
    var evt = window.event || e; 
      if (evt.keyCode == 13){
        window.location.href = '/_search?wd=' + document.getElementById("search-key").value;
      }
    }
  </script>
</div>
  <div class="inner categories">
  <h2><img src="../../../../images/categories.svg" />Categories</h2>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%9F%BA%E7%A1%80%E6%95%B0%E5%AD%A6/">基础数学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/dp/">DP</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E4%BF%A1%E6%81%AF%E5%AD%A6/">信息学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E6%95%B0%E8%AE%BA/">数论</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">组合数学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%9B%BE%E8%AE%BA/">图论</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/">字符串</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/">基础算法</a>
  </span>
  
</div>

      </div>
      <div class="flex-hidden">
        
  <div class="inner">
  <h2><img src="../../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a></li>
    <li><a href="#公式">公式</a>
      <ul>
        <li><a href="#并集">并集</a></li>
        <li><a href="#交集">交集</a></li>
      </ul>
    </li>
    <li><a href="#多重集的排列数">多重集的排列数</a></li>
    <li><a href="#多重集的组合数-1">多重集的组合数 1</a></li>
    <li><a href="#多重集的组合数-2">多重集的组合数 2</a></li>
  </ul>
</nav>
</div>



      </div>
    </div>
  </div>

  
<div class="blog-page">
  <article class="post-content">
    
    <div class="post-header">
      <h1>容斥原理</h1>
      <span class="post-meta">
        
          <img src="../../../../images/time.svg"></img>
          Sep 6, 2021
        
      </span>
      <span class="post-categories">
        
          <a href="../../../../categories/%e4%bf%a1%e6%81%af%e5%ad%a6/">信息学</a>
        
          <a href="../../../../categories/%e6%95%b0%e8%ae%ba/">数论</a>
        
          <a href="../../../../categories/%e7%bb%84%e5%90%88%e6%95%b0%e5%ad%a6/">组合数学</a>
        
      </span>
    </div>
    
    <p><strong>注意</strong>：若无特殊说明，本章涉及的变量皆为正整数.</p>
<h2 id="简介">简介 <a class="anchor" href="#%e7%ae%80%e4%bb%8b">¶</a></h2><p>容斥原理是一种不重不漏的计数原理.</p>
<p>举个例子，$A,B,C$ 三人竞选扫黄队长：</p>
<div class="book-columns flex flex-wrap">

  <div class="markdown-inner">
    <ul>
<li>
<p>$15$ 人投给 $A$</p>
</li>
<li>
<p>$16$ 人投给 $B$</p>
</li>
<li>
<p>$17$ 人投给 $C$</p>
</li>
<li>
<p>$2$ 人同时投给 $A,B,C$</p>
</li>
</ul>

  </div>

  <div class="markdown-inner">
    <ul>
<li>
<p>$4$ 人同时投给 $A,B$</p>
</li>
<li>
<p>$5$ 人同时投给 $A,C$</p>
</li>
<li>
<p>$6$ 人同时投给 $B,C$</p>
</li>
</ul>

  </div>

</div>

<p>问共有多少人参与投票.</p>
<p>$A,B,C$ 三人的得票情况可以用小学二年级就学过的韦恩图描述：</p>
<p><img class="md__image" src="0.svg" alt=""  /></p>
<div class="book-columns flex flex-wrap">

  <div class="markdown-inner">
    <ul>
<li>
<p>$|A|=15$</p>
</li>
<li>
<p>$|B|=16$</p>
</li>
<li>
<p>$|C|=17$</p>
</li>
<li>
<p>$|A∩B∩C|=2$</p>
</li>
</ul>

  </div>

  <div class="markdown-inner">
    <ul>
<li>
<p>$|A∩B|=4$</p>
</li>
<li>
<p>$|A∩C|=5$</p>
</li>
<li>
<p>$|B∩C|=6$</p>
</li>
</ul>

  </div>

</div>

<p>问题是求投票人数，即 $|A∪B∪C|$.</p>
<p>$$|A∪B∪C|=|A|+|B|+|C|-|A∩B|-|A∩C|-|B∩C|+|A∩B∩C|$$</p>
<p>将上述问题推广到普遍情况，就是容斥原理.</p>
<h2 id="公式">公式 <a class="anchor" href="#%e5%85%ac%e5%bc%8f">¶</a></h2><h3 id="并集">并集 <a class="anchor" href="#%e5%b9%b6%e9%9b%86">¶</a></h3><p>对于 $n$ 个集合 $S_1,S_2\cdots S_n$，$|S|$ 表示集合 $S$ 的元素数，则：</p>
<p>$$\left|\bigcup_{i=1}^nS_i\right|=\sum_i|S_i|-\sum_{i &lt; j}|S_i∩S_j|+\sum_{i &lt; j &lt; k}|S_i∩S_j∩S_k|-\cdots+(-1)^{n+1}\left|\bigcap_{i=1}^nS_i\right|$$</p>

<details >
  <summary><label class="material-icons-round">chevron_right</label>证</summary>
  <div class="markdown-inner"><p>设 $x\in S_{a_1},S_{a_2},\cdots,S_{a_m}$，根据公式，$\su\left|\bigcup_{i=1}^nS_i\right|$ 中包含元素 $x$ 的个数为：</p>
<p>$$cnt(x)=m-{m\choose 2}+{m\choose 3}-\cdots+(-1)^{n+1}{m\choose m}={m\choose 0}-\sum_{i=0}^m(-1)^i{m\choose i}$$</p>
<p>根据 <a href="../../../../docs/NOI/Math/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86/">二项式定理</a> 有：</p>
<p>$$(1-1)^m=\sum_{i=0}^m{m\choose i}1^{m-i}\cdot(-1^i)=\sum_{i=0}^m(-1)^i{m\choose i}$$</p>
<p>$$∴cnt(x)={m\choose 0}-(1-1)^m=1$$</p>
<p>每个元素只出现一次，等价于并集，证毕.</p>
</div>
</details>
<h3 id="交集">交集 <a class="anchor" href="#%e4%ba%a4%e9%9b%86">¶</a></h3><p>对于 $n$ 个集合 $S_1,S_2\cdots S_n$，已知全集为 $U$：</p>
<p>$$\left|\bigcap_{i=1}^nS_i\right|=|U|-\left|\bigcup_{i=1}^n\overline{S_i}\right|$$</p>
<p>其中 $\su\left|\bigcup_{i=1}^n\overline{S_i}\right|$ 套用 <a href="../../../../docs/NOI/Math/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/#%E5%B9%B6%E9%9B%86">并集</a> 的公式计算即可.</p>
<h2 id="多重集的排列数">多重集的排列数 <a class="anchor" href="#%e5%a4%9a%e9%87%8d%e9%9b%86%e7%9a%84%e6%8e%92%e5%88%97%e6%95%b0">¶</a></h2><p>普通集合中，不允许有相同的元素；多重集中，相同的元素可以出现多次.</p>
<p>设 $S=\{n_1\cdot a_1,n_2\cdot a_2,\cdots,n_k\cdot a_k\}$ 是由 $n_1$ 个 $a_1$，$n_2$ 个 $a_2$ &hellip; $n_k$ 个 $a_k$ 组成的多重集，$\su n=\sum_{i=1}^kn_i$. $S$ 的全排列个数为：</p>
<p>$$\frac{n!}{n_1!n_2!\cdots n_k!}$$</p>

<details >
  <summary><label class="material-icons-round">chevron_right</label>证</summary>
  <div class="markdown-inner"><p>$n$ 个不同元素的全排列有 $n!$ 种.</p>
<p>若其中有 $j$ 个元素相同，则 $n!$ 种全排列中有部分也是相同的.</p>
<p>单独看这 $j$ 个元素，有 $j!$ 种排列，但它们现在是一样的. 于是总的排列数为：</p>
<p>$$\dfrac{n}{j!}$$</p>
<p>根据 <a href="../../../../docs/NOI/Math/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#%E4%B9%98%E6%B3%95%E5%8E%9F%E7%90%86">乘法原理</a>，多重集的全排列个数为：</p>
<p>$$\frac{n!}{n_1!n_2!\cdots n_k!}$$</p>
</div>
</details>
<h2 id="多重集的组合数-1">多重集的组合数 1 <a class="anchor" href="#%e5%a4%9a%e9%87%8d%e9%9b%86%e7%9a%84%e7%bb%84%e5%90%88%e6%95%b0-1">¶</a></h2><p>设 $S=\{∞\cdot a_1,∞\cdot a_2,\cdots,∞\cdot a_k\}$，从 $S$ 中任取 $λ$ 个元素的方案数为：</p>
<p>$${k+λ-1\choose k-1}$$</p>

<details >
  <summary><label class="material-icons-round">chevron_right</label>证</summary>
  <div class="markdown-inner"><p>原问题等价于求以下方程非负整数解的个数：</p>
<p>$$x_1+x_2+\cdots+x_k=λ$$</p>
<p>解的个数用插板法计算：</p>
<p>在 $λ$ 个 $1$ 之间插 $k-1$ 块板，使其分为 $k$ 个区间. 第 $i$ 个区间的和代表 $x_i$. 这样就构造出了一组解.</p>
<p><span><font color="red">Waiting&hellip;</font></span></p>
<p>需要注意，板插在两端或同一个空隙中是允许的.</p>
<p>最初有 $λ+1$ 个空隙. 插第一块板有 $λ+1$ 种方法，第二块有 $λ+2$ 种，第三块有 $λ+3$ 种 &hellip; 第 $k-1$ 块有 $λ+k-1$ 种. 根据 <a href="../../../../docs/NOI/Math/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#%E4%B9%98%E6%B3%95%E5%8E%9F%E7%90%86">乘法原理</a>，总的方案数为：</p>
<p>$$(λ+1)(λ+2)(λ+3)\cdots(λ+k-1)=A_{λ+k-1}^{k-1}$$</p>
<p>但是插板的顺序与答案无关. 这么算显然会包含一些重复情况：</p>
<p><span><font color="red">Waiting&hellip;</font></span></p>
<p>每一个方案都有 $(k-1)!$ 种不同的插板顺序，故答案为：</p>
<p>$$\dfrac{A_{λ+k-1}^{k-1}}{(k-1)!}={k+λ-1\choose k-1}$$</p>
</div>
</details>
<h2 id="多重集的组合数-2">多重集的组合数 2 <a class="anchor" href="#%e5%a4%9a%e9%87%8d%e9%9b%86%e7%9a%84%e7%bb%84%e5%90%88%e6%95%b0-2">¶</a></h2><p>设 $S=\{n_1\cdot a_1,n_2\cdot a_2,\cdots,n_k\cdot a_k\}$，从 $S$ 中任取 $λ(λ≤\sum_in_i)$ 个元素的方案数为：</p>
<div>
$$
{k+λ-1\choose k-1}-\sum_i{k+λ-n_i-2\choose k-1}+\sum_{i < j}{k+λ-n_i-n_j-3\choose k-1}-\cdots+(-1)^k{k+λ-\sum_in_i-k-1\choose k-1}
$$
</div>

<details >
  <summary><label class="material-icons-round">chevron_right</label>证</summary>
  <div class="markdown-inner"><p>考虑容斥原理：</p>
<center>合法方案数 $=$ 总方案数 $-$ 不合法方案数</center>
<p>总方案数 $\su={k+λ-1\choose k-1}$，详见 <a href="../../../../docs/NOI/Math/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/#%E5%A4%9A%E9%87%8D%E9%9B%86%E7%9A%84%E7%BB%84%E5%90%88%E6%95%B0-1">多重集的组合数 1</a>.</p>
<p>于是问题转化为求不合法方案数.</p>
<ul>
<li>
<p>设 $T_i$ 为 $a_i$ 超标的多重集. 先取 $n_i+1$ 个 $a_i$，再任取 $λ-n_i-1$ 个元素，加入 $T_i$. 不同 $T_i$ 的数量为 $\su{k+λ-n_i-2\choose k-1}$.</p>
</li>
<li>
<p>设 $T_{ij}$ 为 $a_i,a_j$ 超标的多重集. 先取 $n_i+1$ 个 $a_i$ 和 $n_j+1$ 个 $a_j$，再任取 $λ-n_i-n_j-2$ 个元素，加入 $T_{ij}$. 不同 $T_{ij}$ 的数量为 $\su{k+λ-n_i-n_j-3\choose k-1}$.</p>
</li>
</ul>
<p>依次类推，由容斥原理可得，不合法的方案数为：</p>
<p>$$\left|\bigcup\{T\}\right|=\sum_i{k+λ-n_i-2\choose k-1}-\sum_{i &lt; j}{k+λ-n_i-n_j-3\choose k-1}+\cdots+(-1)^{k+1}{k+λ-\sum_in_i-k-1\choose k-1}$$</p>
<p>于是合法的方案数为：</p>
<p>$${k+λ-1\choose k-1}-\left|\bigcup\{T\}\right|$$</p>
</div>
</details>

  </article>
</div>



  <div class="flex-right">
    <div class="outer">
      
  <div class="inner">
  <h2><img src="../../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a></li>
    <li><a href="#公式">公式</a>
      <ul>
        <li><a href="#并集">并集</a></li>
        <li><a href="#交集">交集</a></li>
      </ul>
    </li>
    <li><a href="#多重集的排列数">多重集的排列数</a></li>
    <li><a href="#多重集的组合数-1">多重集的组合数 1</a></li>
    <li><a href="#多重集的组合数-2">多重集的组合数 2</a></li>
  </ul>
</nav>
</div>



    </div>
  </div>

  <script src="../../../../js/jquery.min.js"></script>


<script defer>
function IsPC() {  
  var userAgentInfo = navigator.userAgent;
  var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");  
  for (var v = 0; v < Agents.length; v ++) {  
    if (userAgentInfo.indexOf(Agents[v]) > 0) {
      return false;
    }
  }
  return true;
}
function detectZoom() {
  var ratio = 0,
  screen = window.screen,
  ua = navigator.userAgent.toLowerCase();
  if (window.devicePixelRatio !== undefined)
    ratio = window.devicePixelRatio;
  else if (~ua.indexOf('msie')) {
    if (screen.deviceXDPI && screen.logicalXDPI)
      ratio = screen.deviceXDPI / screen.logicalXDPI;
  }
  else if (window.outerWidth !== undefined && window.innerWidth !== undefined)
    ratio = window.outerWidth / window.innerWidth;
  
  if (ratio)
    ratio = Math.round(ratio * 100);
  return ratio;
}
$('img').each(function(id, el, arr) {
  if (el.parentElement.tagName == 'P') {
    el.className = "md__image";
    var src = el.getAttribute('src');
    if (IsPC() && src.substr(src.lastIndexOf(".") + 1) != "svg") {
      if (el.style.zoom)
        el.style.zoom = parseFloat(el.style.zoom) / detectZoom();
      else
        el.style.zoom = 100 / detectZoom();
    }
  }
});

















</script>





<link rel="stylesheet" href="../../../../katex/katex.min.css">
<script src="../../../../katex/katex.min.js"></script>
<script src="../../../../katex/auto-render.min.js"></script>

<script>
  function renderTex() {
    renderMathInElement(document.body, {
      trust: true,
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ],
      macros: {
        
        "\\d": "\\text{d}",
        "\\zh": "\\footnotesize \\ ",
        "\\en": "\\normalsize \\ ",
        "\\su": "\\displaystyle",
        "\\eq": "\\Longleftrightarrow",
        "\\intro": "\\Longrightarrow",
        "\\mathring": "\\overset\{\\normalsizeₒ\}",
        "\\arccot": "\\text\{arccot\} \\, ",
        "\\xor": "\\text\{xor\} \\, ",
        "\\mex": "\\text\{mex\} \\, "
      }
    });
  }  
  document.addEventListener("DOMContentLoaded", function() {
    renderTex();
  });

</script>

<script>
  $('.language-latex').each(function(id, el, arr) {
    function toText(text) { 
      var temp = document.createElement("div"); 
      temp.innerHTML = text; 
      var output = temp.innerText || temp.textContent; 
      temp = null; 
      return output; 
    } 
    tex = toText(el.innerHTML);
    el.parentElement.outerHTML = '<div>$$' + tex + '$$</div>';
  });

</script>

<script>
  $('table').each(function(id, el, arr) {
    el.outerHTML = `<div class="md__table">${el.outerHTML}</div>`;
  });
</script>



<script src="../../../../js/mermaid.min.js"></script>

<script>
  mermaid.initialize({
    
    themeCSS: ".node rect { \
      fill: transparent;    \
      stroke: transparent;  \
    }                       \
    .nodeLabel {            \
      font-size: 24px;      \
    }",
    startOnLoad: true,
    flowchart: {
      curve: 'cardinal'
    },
    securityLevel: 'loose',
  });
</script>

<script>
  Array.from(document.getElementsByClassName("language-mermaid")).forEach(
    (el) => {
      el.parentElement.outerHTML = `<div class="mermaid">${el.innerText}</div>`;
    }
  );
</script>

  
</main>
</body>
</html>