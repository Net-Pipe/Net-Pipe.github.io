<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>最短路径 &#8211; NetPipe&#39;s Blog</title>

  
  <meta name="description" content="简介 ¶现在给你 $n$ 个节点（编号为 $1\sim n$）和它们之间的边长，求任意两个节点之间的最短路径.">
  
  <meta name="author" content="Net Pipe">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../../../index.xml" rel="alternate" type="application/rss+xml" title="NetPipe&#39;s Blog" />
  <link rel="shortcut icon" type="image/x-icon" href="../../../images/freeze.png" />

  
    <style>@font-face {
  font-family: 'Fantasque Sans Mono';
  src: url("/fonts/FantasqueSansMono-Regular.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: normal;
  font-weight: bold;
  src: url("/fonts/FantasqueSansMono-Bold.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: italic;
  src: url("/fonts/FantasqueSansMono-Italic.woff2") format("woff2"); }

@font-face {
  font-family: 'Lazy';
  src: url("/fonts/lazy.ttf") format("truetype"); }

@font-face {
  font-family: 'Material Icons';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Outlined';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Outlined.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Round';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Round.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Sharp';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Sharp.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Two Tone';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Two Tone.woff2") format("woff2"); }

.material-icons {
  font-family: 'Material Icons';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-outlined {
  font-family: 'Material Icons Outlined';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-round {
  font-family: 'Material Icons Round';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-sharp {
  font-family: 'Material Icons Sharp';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-two-tone {
  font-family: 'Material Icons Two Tone';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

body,
code,
input {
  font-family: 'Fantasque Sans Mono', sans-serif;
  -webkit-font-smoothing: antialiased; }
  body article h1, body article h2, body article h3, body article h4, body article h5, body article h6, body .posts h1, body .posts h2, body .posts h3, body .posts h4, body .posts h5, body .posts h6,
  code article h1,
  code article h2,
  code article h3,
  code article h4,
  code article h5,
  code article h6,
  code .posts h1,
  code .posts h2,
  code .posts h3,
  code .posts h4,
  code .posts h5,
  code .posts h6,
  input article h1,
  input article h2,
  input article h3,
  input article h4,
  input article h5,
  input article h6,
  input .posts h1,
  input .posts h2,
  input .posts h3,
  input .posts h4,
  input .posts h5,
  input .posts h6 {
    font-weight: normal; }

strong {
  font-weight: normal;
  text-shadow: 0 0; }

* {
  margin: 0;
  padding: 0;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  --aside-width: 18rem;
  --box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.1);
  --box-shadow-hover: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  --color: black;
  --border: 1px solid #dee0e2;
  --border-color: #dee0e2;
  --border-radius: 0.25rem;
  --link-color: #4588be;
  --category-color: rgba(38, 152, 190, 0.7);
  --background-color: white;
  --hover-color: #f7f7f7; }
  * body {
    background-color: #f7f7f7; }

::selection {
  background-color: #CCE2FF;
  color: rgba(0, 0, 0, 0.87); }

::-webkit-scrollbar {
  width: 7px;
  height: 7px; }

::-webkit-scrollbar-thumb {
  border-radius: 10px;
  background: #dddddd; }
  ::-webkit-scrollbar-thumb:hover {
    background: #acacac; }

::-webkit-scrollbar-track {
  border-radius: 10px;
  background: #f0f0f0; }

a {
  text-decoration: none;
  color: #4794d3; }

a:focus, a:hover {
  outline: none;
  text-decoration: underline; }

a.alternate:focus,
a.alternate:hover,
a.alternate:focus > *,
a.alternate:hover > * {
  text-decoration: none;
  background: var(--hover-color); }

small {
  font-size: 70%; }

ol, ul {
  margin: .5rem 0;
  padding-left: 2rem;
  word-break: break-word; }
  ol > li, ul > li {
    margin: .5rem 0; }

ul > li {
  list-style: circle; }

.result {
  width: 100%; }
  .result :first-child .post {
    margin-top: 0; }
  .result :last-child .post {
    margin-bottom: 0; }

.flex-left,
.flex-right {
  flex: 0 0 var(--aside-width); }
  .flex-left div.outer,
  .flex-right div.outer {
    padding: .7rem;
    margin: .3rem;
    width: calc(var(--aside-width) - 2rem);
    height: calc(100% - 2rem);
    position: fixed;
    overflow: auto; }
    .flex-left div.outer::-webkit-scrollbar-track,
    .flex-right div.outer::-webkit-scrollbar-track {
      margin: .7rem; }
  .flex-left div.inner,
  .flex-right div.inner {
    direction: ltr;
    background-color: var(--background-color);
    color: var(--color);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    box-sizing: border-box;
    width: calc(var(--aside-width) - 2rem);
    padding: .5rem;
    margin-bottom: 1rem;
    overflow: auto;
    padding: 1rem; }
    .flex-left div.inner:hover,
    .flex-right div.inner:hover {
      box-shadow: var(--box-shadow-hover); }
    .flex-left div.inner h2,
    .flex-right div.inner h2 {
      margin: 0 0 .5rem 0;
      line-height: 20px; }
      .flex-left div.inner h2 > img,
      .flex-right div.inner h2 > img {
        vertical-align: -2px;
        width: 20px;
        height: 20px;
        margin-right: .5rem; }
    .flex-left div.inner ul,
    .flex-right div.inner ul {
      padding-left: 1rem; }
    .flex-left div.inner:last-of-type,
    .flex-right div.inner:last-of-type {
      margin-bottom: 0; }
  .flex-left div.avatar,
  .flex-right div.avatar {
    text-align: center; }
    .flex-left div.avatar h2,
    .flex-right div.avatar h2 {
      margin: 1rem; }
    .flex-left div.avatar img.avatar,
    .flex-right div.avatar img.avatar {
      transition: all 0.3s;
      border-radius: 1rem;
      box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.2); }
      .flex-left div.avatar img.avatar:hover,
      .flex-right div.avatar img.avatar:hover {
        transform: perspective(1px) scale(1.04); }
    .flex-left div.avatar .data-left,
    .flex-left div.avatar .data-right,
    .flex-right div.avatar .data-left,
    .flex-right div.avatar .data-right {
      flex: 0 0 50%;
      display: inline-block;
      width: calc(50% - 1rem); }
    .flex-left div.avatar .data-left,
    .flex-right div.avatar .data-left {
      border-right: 1px solid var(--color); }
    .flex-left div.avatar .social,
    .flex-right div.avatar .social {
      margin-top: 1rem; }
      .flex-left div.avatar .social .social-box,
      .flex-right div.avatar .social .social-box {
        border-radius: var(--border-radius);
        box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.2);
        background-color: var(--background-color);
        color: var(--color);
        transition: all 0.3s;
        margin-top: .5rem;
        padding: .5rem;
        text-align: left;
        font-size: 18px; }
        .flex-left div.avatar .social .social-box a,
        .flex-right div.avatar .social .social-box a {
          color: var(--color); }
        .flex-left div.avatar .social .social-box:hover a,
        .flex-right div.avatar .social .social-box:hover a {
          color: var(--link-color);
          text-decoration: underline; }
        .flex-left div.avatar .social .social-box:hover,
        .flex-right div.avatar .social .social-box:hover {
          transform: perspective(1px) scale(1.04); }
        .flex-left div.avatar .social .social-box img,
        .flex-right div.avatar .social .social-box img {
          vertical-align: text-bottom;
          width: 20px; }
        .flex-left div.avatar .social .social-box .search,
        .flex-right div.avatar .social .social-box .search {
          display: inline-block;
          width: calc(100% - 36px); }
          .flex-left div.avatar .social .social-box .search > input,
          .flex-right div.avatar .social .social-box .search > input {
            background-color: var(--background-color);
            color: var(--color);
            border: none;
            font-size: 17px;
            outline: none;
            width: 100%; }
  .flex-left div.categories .post-categories,
  .flex-right div.categories .post-categories {
    display: inline-block;
    transition: all 0.1s;
    line-height: 1.7rem; }
    .flex-left div.categories .post-categories:hover,
    .flex-right div.categories .post-categories:hover {
      transform: perspective(1px) scale(1.04); }
  .flex-left #TableOfContents > ul,
  .flex-right #TableOfContents > ul {
    padding-left: 0;
    margin-bottom: -.5rem; }
    .flex-left #TableOfContents > ul li,
    .flex-right #TableOfContents > ul li {
      list-style: none; }

.flex-left {
  margin-right: -1rem; }

.flex-right {
  margin-left: -1rem; }

.flex-hidden {
  display: none; }

.pagination {
  margin: 0;
  padding: 0;
  width: 100%;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: center;
  font-size: 18px; }
  .pagination div.pagination-box {
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color);
    margin: 0 .5rem;
    color: var(--link-color);
    width: 2rem;
    height: 2rem;
    line-height: 2rem;
    float: left;
    text-align: center;
    vertical-align: middle;
    cursor: default; }
    .pagination div.pagination-box:hover {
      box-shadow: var(--box-shadow-hover); }
    .pagination div.pagination-box:not(.disabled):hover {
      background-color: var(--hover-color);
      cursor: pointer; }
  .pagination div.prev {
    width: 5rem;
    margin-left: 0; }
  .pagination div.next {
    width: 5rem;
    margin-right: 0; }
  .pagination div.pagination-eldivpsis {
    width: 3rem; }
  .pagination div.disabled {
    color: var(--color); }

.posts .post {
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  background-color: var(--background-color);
  color: var(--color);
  margin: 1rem 0;
  padding: .7rem 1rem; }
  .posts .post:hover {
    box-shadow: var(--box-shadow-hover); }

.posts :first-child .post {
  margin-top: 0; }

.post-list {
  border: var(--border);
  border-radius: var(--border-radius); }
  .post-list .post-item {
    padding: .3rem .5rem;
    height: 1.5rem; }
    .post-list .post-item * {
      font-size: 100%;
      vertical-align: bottom; }
    .post-list .post-item:hover a {
      color: var(--link-color);
      text-decoration: underline; }

.post-link {
  color: var(--color); }
  .post-link:hover .post-title a {
    color: var(--link-color);
    text-decoration: underline; }

.post-title {
  margin: 0 0 .5rem 0;
  font-size: 20px; }
  .post-title a {
    color: var(--color); }
  .post-title:hover a {
    color: var(--link-color);
    text-decoration: underline; }

.post-meta {
  color: gray; }
  .post-meta img {
    vertical-align: text-bottom; }

.post-categories {
  font-size: 13px; }
  .post-categories a {
    color: white;
    background-color: var(--category-color);
    border-radius: .2rem;
    padding: .2rem .2rem;
    white-space: nowrap; }

.post-summary {
  margin-top: .5rem; }

.post-header {
  margin-bottom: 1rem; }

.post-content {
  text-align: justify;
  background-color: white;
  padding: 1rem; }
  .post-content .md__image {
    display: block;
    max-width: 100%;
    margin: auto; }

.post-content > :first-child,
.post-content > :first-child > :first-child,
.post-content > :first-child > :first-child > :first-child,
.markdown-inner > :first-child,
.markdown-inner > :first-child > :first-child,
.markdown-inner > :first-child > :first-child > :first-child {
  margin-top: 0; }

.post-content > :last-child,
.post-content > :last-child > :last-child,
.post-content > :last-child > :last-child > :last-child,
.markdown-inner > :last-child,
.markdown-inner > :last-child > :last-child,
.markdown-inner > :last-child > :last-child > :last-child {
  margin-bottom: 0; }

body {
  max-width: 75rem;
  margin: 0 auto;
  overflow: hidden scroll; }

main {
  display: flex; }

article {
  overflow: hidden;
  will-change: transform; }

.blog-page {
  flex-grow: 1;
  min-width: 18rem;
  padding: 1rem;
  width: calc(100% - 42rem); }
  .blog-page .post-toc {
    display: none; }
  .blog-page .post-pagination {
    width: 100%;
    height: 2rem; }
  .blog-page .post-content {
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color); }
    .blog-page .post-content:hover {
      box-shadow: var(--box-shadow-hover); }

@media screen and (max-width: 70rem) {
  .flex-left .flex-visible {
    margin-bottom: 1rem; }
  .flex-left .flex-hidden {
    display: block; }
  .flex-right {
    display: none; } }

@media screen and (max-width: 48rem) {
  main {
    display: block; }
  .flex-left {
    width: 100%;
    margin: 0;
    margin-bottom: -1rem; }
    .flex-left div.outer {
      position: relative;
      width: auto; }
    .flex-left div.inner {
      width: auto; }
  .blog-page {
    width: calc(100% - 2rem); } }

@media screen and (max-width: 25rem) {
  .pagination div.pagination-box {
    margin: 0 .25rem; } }

.book-columns {
  display: flex;
  flex-wrap: wrap;
  margin: .5rem;
  margin-left: -.5rem;
  margin-right: -.5rem; }
  .book-columns .markdown-inner {
    margin: .5rem;
    flex: 1 1; }

.book-tabs {
  margin: .5em 0;
  overflow: hidden;
  display: flex;
  flex-wrap: wrap; }
  .book-tabs label {
    line-height: 1rem;
    display: inline-block;
    padding: .3rem 16px;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    cursor: pointer;
    z-index: 999;
    border: 1px solid transparent;
    vertical-align: baseline; }
  .book-tabs .book-tabs-content,
  .book-tabs .book-tabs-pure-content {
    order: 999;
    width: 100%;
    display: none;
    overflow: hidden;
    border-bottom-left-radius: var(--border-radius);
    border-bottom-right-radius: var(--border-radius); }
  .book-tabs .book-tabs-content {
    border: var(--border);
    padding: .5rem; }
  .book-tabs input[type="radio"] {
    display: none; }
    .book-tabs input[type="radio"]:not(:checked) + label {
      color: #95A5A6; }
      .book-tabs input[type="radio"]:not(:checked) + label:hover {
        background-color: var(--hover-color); }
    .book-tabs input[type="radio"]:checked + label {
      border: var(--border);
      border-bottom: none; }
      .book-tabs input[type="radio"]:checked + label + .book-tabs-content, .book-tabs input[type="radio"]:checked + label + .book-tabs-pure-content {
        display: block; }
    .book-tabs input[type="radio"]:first-of-type:checked + label + .book-tabs-pure-content :first-child {
      border-top-left-radius: 0; }

details {
  border: var(--border);
  border-radius: var(--border-radius);
  margin: .5rem 0;
  padding: .5rem  1rem .5rem  0.75rem; }
  details summary {
    font-size: 12.8px;
    font-weight: bold; }
    details summary::marker {
      content: '';
      font-size: 0; }
  details ::-webkit-details-marker {
    content: '';
    font-size: 0; }
  details ::-moz-list-bullet {
    content: '';
    font-size: 0; }
  details label {
    font-size: 20px !important;
    margin-left: -5px;
    margin-right: 5px;
    vertical-align: -4.5px; }
  details[open] > summary {
    margin-bottom: 0; }
    details[open] > summary label {
      transform: rotate(90deg); }
  details .markdown-inner {
    padding: .5rem 0; }
  details:focus {
    outline: none; }

article h1 {
  font-size: 200%;
  line-height: 110%; }

article h2 {
  font-size: 140%;
  line-height: 120%; }

article h3 {
  font-size: 120%;
  line-height: 120%; }
  article h3 .katex {
    font-size: 100%; }

article h4 {
  font-size: 110%; }

article p {
  margin: .5rem 0;
  line-height: 1.5rem; }

article h1, article h2, article h3, article h4, article h5, article h6 {
  margin: .7rem 0; }
  article h1 .anchor, article h2 .anchor, article h3 .anchor, article h4 .anchor, article h5 .anchor, article h6 .anchor {
    opacity: 0; }
  article h1:hover .anchor, article h1:focus .anchor, article h2:hover .anchor, article h2:focus .anchor, article h3:hover .anchor, article h3:focus .anchor, article h4:hover .anchor, article h4:focus .anchor, article h5:hover .anchor, article h5:focus .anchor, article h6:hover .anchor, article h6:focus .anchor {
    opacity: 1; }

article hr {
  border: none;
  border-bottom: 1px solid #ebeced; }

article blockquote {
  border: var(--border);
  border-radius: var(--border-radius);
  border-left: .3rem solid lightgray;
  padding: 0 .5rem; }

article pre {
  border: var(--border);
  border-radius: var(--border-radius);
  margin: .5rem 0;
  padding: .5rem 1rem;
  overflow-x: auto;
  line-height: 22px; }

article code {
  border: var(--border);
  border-radius: var(--border-radius);
  padding: 1px 2px; }

article pre {
  color: #686868; }
  article pre code {
    border: none;
    padding: 0; }
  article pre * {
    user-select: text;
    -moz-user-select: text;
    -webkit-user-select: text; }

article code:focus {
  outline: none; }

article .md__table {
  margin: -.5rem;
  padding: .5rem;
  overflow: auto; }
  article .md__table::-webkit-scrollbar-track {
    margin: .5rem; }
  article .md__table table {
    border: var(--border);
    border-radius: var(--border-radius);
    border-spacing: 0;
    overflow: auto;
    -webkit-overflow-scrolling: touch; }
    article .md__table table th {
      font-weight: normal; }
    article .md__table table td {
      border-top: 1px solid var(--border-color); }
    article .md__table table th, article .md__table table td {
      padding: .3rem 16px;
      white-space: nowrap; }

article .mermaid svg {
  display: block;
  margin: auto;
  zoom: 80%; }
</style>
  
</head>






<body>
<main>
  <div class="flex-left">
    <div class="outer">
      <div class="flex-visible">
        
  <div class="inner avatar">
  <a href="../../../"><img src="../../../images/NetPipe.png" class="avatar" width="96px" height="96px" /></a>
  <h2>Net Pipe</h2>
  <div class="data-left">
    <h3>57</h3>
    <span>Posts</span>
  </div>
  <div class="data-right">
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    <h3>18390</h3>
    <span>Words</span>
  </div>
  <div class="social">
    <div class="social-box">
      <img src="../../../images/search.svg"/>
      <div class="search">
        <input type="text" placeholder="Search" id="search-key" maxlength="64" data-hotkeys="s/" onkeydown="keyup_submit(event);" />
      </div>
    </div>
    <a class="alternate" href="../../../">
      <div class="social-box">
        <img src="../../../images/home.svg"/>
        <object><a href="../../../">Home</a></object>
      </div>
    </a>
    <a class="alternate" href="../../../post/">
      <div class="social-box">
        <img src="../../../images/posts.svg"/>
        <object><a href="../../../post/">Posts</a></object>
      </div>
    </a>
    <a class="alternate" type="application/rss+xml" href="../../../index.xml">
      <div class="social-box">
        <img src="../../../images/rss.svg"/>
        <object><a  type="application/rss+xml" href="../../../index.xml">RSS</a></object>
      </div>
    </a>
  </div>
  <script>
    function keyup_submit(e){ 
    var evt = window.event || e; 
      if (evt.keyCode == 13){
        window.location.href = '/_search?wd=' + document.getElementById("search-key").value;
      }
    }
  </script>
</div>
  <div class="inner categories">
  <h2><img src="../../../images/categories.svg" />Categories</h2>
  
  <span class="post-categories">
    <a href="../../../categories/%E5%9F%BA%E7%A1%80%E6%95%B0%E5%AD%A6/">基础数学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/dp/">DP</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/%E4%BF%A1%E6%81%AF%E5%AD%A6/">信息学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/%E6%95%B0%E8%AE%BA/">数论</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">组合数学</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/%E5%9B%BE%E8%AE%BA/">图论</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/">字符串</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/">基础算法</a>
  </span>
  
</div>

      </div>
      <div class="flex-hidden">
        
  <div class="inner">
  <h2><img src="../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a></li>
    <li><a href="#松弛操作">松弛操作</a></li>
    <li><a href="#floyed-算法">Floyed 算法</a></li>
    <li><a href="#bellman-ford-算法">Bellman-Ford 算法</a>
      <ul>
        <li><a href="#判断负权回路">判断负权回路</a></li>
      </ul>
    </li>
    <li><a href="#spfa-算法">SPFA 算法</a>
      <ul>
        <li><a href="#判断负权回路-1">判断负权回路</a></li>
      </ul>
    </li>
    <li><a href="#dijkstra-算法">Dijkstra 算法</a></li>
  </ul>
</nav>
</div>



      </div>
    </div>
  </div>

  
<div class="blog-page">
  <article class="post-content">
    
    <div class="post-header">
      <h1>最短路径</h1>
      <span class="post-meta">
        
          <img src="../../../images/time.svg"></img>
          Jun 2, 2021
        
      </span>
      <span class="post-categories">
        
          <a href="../../../categories/%e4%bf%a1%e6%81%af%e5%ad%a6/">信息学</a>
        
          <a href="../../../categories/%e5%9b%be%e8%ae%ba/">图论</a>
        
      </span>
    </div>
    
    <h2 id="简介">简介 <a class="anchor" href="#%e7%ae%80%e4%bb%8b">¶</a></h2><p>现在给你 $n$ 个节点（编号为 $1\sim n$）和它们之间的边长，求任意两个节点之间的最短路径.</p>
<h2 id="松弛操作">松弛操作 <a class="anchor" href="#%e6%9d%be%e5%bc%9b%e6%93%8d%e4%bd%9c">¶</a></h2><p>使用 <a href="../../../docs/NOI/Graph/store/#%E9%82%BB%E6%8E%A5%E7%9F%A9%E9%98%B5">邻接矩阵</a> $g$ 存图.如果 $g[i,k] + g[k,j] &lt; g[i,j]$，则路径 $i→k→j$ 比原先 $i→j$ 的路径更短，那么就令 $g[i,j] = g[i,k] + g[k,j]$.这就是松弛操作.</p>
<p><img class="md__image" src="0.svg" alt=""  /></p>
<h2 id="floyed-算法">Floyed 算法 <a class="anchor" href="#floyed-%e7%ae%97%e6%b3%95">¶</a></h2><p>一开始，我们将所有节点全部拨到图外面，然后按 $1$ 号到 $n$ 号顺序依次往图中加入节点.</p>
<p>$g[k,i,j]$：当图中已经加入了 $1 \sim k$ 号节点时，从节点 $i$ 到 $j$ 的最短路径.</p>
<p>当节点 $k$ 被加入图中时，枚举节点 $i$ 和 $j$，利用新加入的 $k$ 对路径 $i-j$ 进行 <a href="../../../docs/NOI/Graph/shortest-path/#%E6%9D%BE%E5%BC%9B%E6%93%8D%E4%BD%9C">松弛操作</a>：</p>
<ul>
<li>
<p>若路径 $i-j$ 不经过节点 $k$，则 $g[k,i,j] = g[k - 1,i,j]$；</p>
</li>
<li>
<p>若路径 $i-j$ 经过节点 $k$，则 $g[k,i,j] = g[k - 1,i,k] + g[k - 1,k,j]$.</p>
</li>
</ul>
<p>$$g[k,i,j] = \min(g[k - 1,i,j], g[k - 1,i,k] + g[k - 1,k,j])$$</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">k</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">k</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">k</span> <span style="color:#728e00">++</span>)
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>)
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">++</span>)
            <span style="color:#434f54">g</span>[<span style="color:#434f54">k</span>][<span style="color:#434f54">i</span>][<span style="color:#434f54">j</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">g</span>[<span style="color:#434f54">k</span> <span style="color:#728e00">-</span> <span style="color:#8a7b52">1</span>][<span style="color:#434f54">i</span>][<span style="color:#434f54">j</span>], <span style="color:#434f54">g</span>[<span style="color:#434f54">k</span> <span style="color:#728e00">-</span> <span style="color:#8a7b52">1</span>][<span style="color:#434f54">i</span>][<span style="color:#434f54">k</span>] <span style="color:#728e00">+</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">k</span> <span style="color:#728e00">-</span> <span style="color:#8a7b52">1</span>][<span style="color:#434f54">k</span>][<span style="color:#434f54">j</span>]);
</code></pre></div><p>实际上，$g$ 数组的第一维不影响结果，可以摘掉.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">k</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">k</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">k</span> <span style="color:#728e00">++</span>)
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>)
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">++</span>)
            <span style="color:#434f54">g</span>[<span style="color:#434f54">i</span>][<span style="color:#434f54">j</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">g</span>[<span style="color:#434f54">i</span>][<span style="color:#434f54">j</span>], <span style="color:#434f54">g</span>[<span style="color:#434f54">i</span>][<span style="color:#434f54">k</span>] <span style="color:#728e00">+</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">k</span>][<span style="color:#434f54">j</span>]);
</code></pre></div><p><code>Floyed</code> 算法适用于任何图，但图中必须存在最短路.时间复杂度为 $O(n^3)$.</p>
<h2 id="bellman-ford-算法">Bellman-Ford 算法 <a class="anchor" href="#bellman-ford-%e7%ae%97%e6%b3%95">¶</a></h2><p><code>Bellman-Ford</code> 算法是基于 <code>Floyed</code> 算法的优化版本，但是只能处理单源最短路径：每跑一次 <code>Bellman-Ford</code> 算法，都需要给定源节点 $s$，并且只能求得 $s$ 到其它节点的最短路.</p>
<p><code>Floyed</code> 枚举节点的效率太低，于是 <code>Bellman-Ford</code> 改为枚举边.</p>
<p>$n$ 个节点 $m$ 条边的图中，如果存在最短路径，则最短路径所包含的边数 $≤ n-1$.故每条路最多被松弛 $n-1$ 次.$dis[i]$ 表示 $s→i$ 的最短路长度，初始时要设为无穷大.</p>
<p>时间复杂度为 $O(nm)$.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00979d">void</span> <span style="color:#d35400">bellman_ford</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">s</span>) {
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">dis</span>, <span style="color:#8a7b52">0x7f</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">dis</span>);
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) <span style="color:#95a5a6">// 松弛 n - 1 次
</span><span style="color:#95a5a6"></span>        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">m</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">++</span>)
            <span style="color:#434f54">dis</span>[<span style="color:#434f54">to</span>[<span style="color:#434f54">j</span>]] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">dis</span>[<span style="color:#434f54">to</span>[<span style="color:#434f54">j</span>]], <span style="color:#434f54">dis</span>[<span style="color:#434f54">from</span>[<span style="color:#434f54">j</span>]] <span style="color:#728e00">+</span> <span style="color:#434f54">len</span>[<span style="color:#434f54">j</span>]);
}
</code></pre></div><h3 id="判断负权回路">判断负权回路 <a class="anchor" href="#%e5%88%a4%e6%96%ad%e8%b4%9f%e6%9d%83%e5%9b%9e%e8%b7%af">¶</a></h3><p>若图中存在长度为负数的 <a href="../../../docs/NOI/Graph/intro/#%E5%9B%9E%E8%B7%AF%E7%8E%AF">回路</a>，则此回路称为 <strong>负权回路（负环）</strong>.有负权回路的图不存在最短路.</p>
<p>使用 <code>Bellman-Ford</code> 算法时，如果一条路径被松弛了 $n$ 次及以上，则一定存在负权回路.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00979d">bool</span> <span style="color:#d35400">check</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">s</span>) {
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">dis</span>, <span style="color:#8a7b52">0x7f</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">dis</span>);
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>)
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">m</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">++</span>)
            <span style="color:#434f54">dis</span>[<span style="color:#434f54">to</span>[<span style="color:#434f54">j</span>]] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">dis</span>[<span style="color:#434f54">to</span>[<span style="color:#434f54">j</span>]], <span style="color:#434f54">dis</span>[<span style="color:#434f54">from</span>[<span style="color:#434f54">j</span>]] <span style="color:#728e00">+</span> <span style="color:#434f54">len</span>[<span style="color:#434f54">j</span>]);
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">m</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">++</span>)
        <span style="color:#728e00">if</span>(<span style="color:#434f54">dis</span>[<span style="color:#434f54">to</span>[<span style="color:#434f54">j</span>]] <span style="color:#728e00">&gt;</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">from</span>[<span style="color:#434f54">j</span>]] <span style="color:#728e00">+</span> <span style="color:#434f54">len</span>[<span style="color:#434f54">j</span>])
            <span style="color:#728e00">return</span> <span style="color:#728e00">false</span>; <span style="color:#95a5a6">// 松弛了 n - 1 次后，还能进行松弛操作，则存在负权回路
</span><span style="color:#95a5a6"></span>    <span style="color:#728e00">return</span> <span style="color:#728e00">true</span>;
}
</code></pre></div><h2 id="spfa-算法">SPFA 算法 <a class="anchor" href="#spfa-%e7%ae%97%e6%b3%95">¶</a></h2><p><code>SPFA</code> 算法是 <code>Bellman-Ford</code> 算法的队列优化版本.只有上一次被松弛的节点的出边，才有可能引起下一次的松弛操作.每次取队首节点，对其出边进行松弛，将松弛到的节点加入队列.时间复杂度为 $O(kn)$.平均情况下，$k$ 为 $(1,2)$ 中的常数.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#728e00">const</span> <span style="color:#00979d">int</span> <span style="color:#434f54">N</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1e6</span>;
<span style="color:#00979d">bool</span> <span style="color:#434f54">in</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">dis</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// in[i]: u 是否在栈中 
</span><span style="color:#95a5a6"></span><span style="color:#728e00">struct</span> <span style="color:#434f54">node</span> {
    <span style="color:#00979d">int</span> <span style="color:#434f54">val</span>, <span style="color:#434f54">len</span>;
};
<span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// g[u]: u 节点的邻接节点集合
</span><span style="color:#95a5a6"></span>
<span style="color:#00979d">void</span> <span style="color:#d35400">spfa</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">s</span>) {
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">in</span>, <span style="color:#728e00">false</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">in</span>);
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">dis</span>, <span style="color:#8a7b52">0x7f</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">dis</span>);
    <span style="color:#434f54">dis</span>[<span style="color:#434f54">s</span>] <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#434f54">queue</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">Q</span>;
    <span style="color:#434f54">Q</span>.<span style="color:#434f54">push</span>(<span style="color:#434f54">s</span>), <span style="color:#434f54">in</span>[<span style="color:#434f54">s</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">true</span>;
    <span style="color:#728e00">while</span>(<span style="color:#728e00">!</span><span style="color:#434f54">Q</span>.<span style="color:#434f54">empty</span>()) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">u</span> <span style="color:#728e00">=</span> <span style="color:#434f54">Q</span>.<span style="color:#434f54">front</span>();
        <span style="color:#434f54">Q</span>.<span style="color:#434f54">pop</span>(), <span style="color:#434f54">in</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">false</span>;
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> (<span style="color:#00979d">int</span>) <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
            <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>].<span style="color:#434f54">val</span>;
            <span style="color:#00979d">int</span> <span style="color:#434f54">d</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>].<span style="color:#434f54">len</span>;
            <span style="color:#728e00">if</span>(<span style="color:#434f54">dis</span>[<span style="color:#434f54">v</span>] <span style="color:#728e00">&gt;</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">+</span> <span style="color:#434f54">d</span>) {
                <span style="color:#434f54">dis</span>[<span style="color:#434f54">v</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">+</span> <span style="color:#434f54">d</span>;
                <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">in</span>[<span style="color:#434f54">v</span>]) { <span style="color:#95a5a6">// 已经在栈里的节点没必要再进栈一次
</span><span style="color:#95a5a6"></span>                    <span style="color:#434f54">Q</span>.<span style="color:#434f54">push</span>(<span style="color:#434f54">v</span>), <span style="color:#434f54">in</span>[<span style="color:#434f54">v</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">true</span>;
                }
            }
        }
    }
}
</code></pre></div><h3 id="判断负权回路-1">判断负权回路 <a class="anchor" href="#%e5%88%a4%e6%96%ad%e8%b4%9f%e6%9d%83%e5%9b%9e%e8%b7%af-1">¶</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#728e00">const</span> <span style="color:#00979d">int</span> <span style="color:#434f54">N</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1e6</span>;
<span style="color:#00979d">bool</span> <span style="color:#434f54">in</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">dis</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">relax</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// relax[u]: dis[u] 被松弛的次数
</span><span style="color:#95a5a6"></span><span style="color:#728e00">struct</span> <span style="color:#434f54">node</span> {
    <span style="color:#00979d">int</span> <span style="color:#434f54">val</span>, <span style="color:#434f54">len</span>;
};
<span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">N</span>];

<span style="color:#00979d">bool</span> <span style="color:#d35400">spfa</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">s</span>) {
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">in</span>, <span style="color:#728e00">false</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">in</span>);
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">dis</span>, <span style="color:#8a7b52">0x7f</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">dis</span>);
    <span style="color:#434f54">dis</span>[<span style="color:#434f54">s</span>] <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#434f54">queue</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">Q</span>;
    <span style="color:#434f54">Q</span>.<span style="color:#434f54">push</span>(<span style="color:#434f54">s</span>), <span style="color:#434f54">in</span>[<span style="color:#434f54">s</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">true</span>;
    <span style="color:#728e00">while</span>(<span style="color:#728e00">!</span><span style="color:#434f54">Q</span>.<span style="color:#434f54">empty</span>()) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">u</span> <span style="color:#728e00">=</span> <span style="color:#434f54">Q</span>.<span style="color:#434f54">front</span>();
        <span style="color:#434f54">Q</span>.<span style="color:#434f54">pop</span>(), <span style="color:#434f54">in</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">false</span>;
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> (<span style="color:#00979d">int</span>) <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
            <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>].<span style="color:#434f54">val</span>;
            <span style="color:#00979d">int</span> <span style="color:#434f54">d</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>].<span style="color:#434f54">len</span>;
            <span style="color:#728e00">if</span>(<span style="color:#434f54">dis</span>[<span style="color:#434f54">v</span>] <span style="color:#728e00">&gt;</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">+</span> <span style="color:#434f54">d</span>) {
                <span style="color:#434f54">dis</span>[<span style="color:#434f54">v</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">+</span> <span style="color:#434f54">d</span>;
                <span style="color:#728e00">if</span>(<span style="color:#728e00">++</span> <span style="color:#434f54">relax</span>[<span style="color:#434f54">v</span>] <span style="color:#728e00">&gt;=</span> <span style="color:#434f54">n</span>) <span style="color:#95a5a6">// 松弛了 n 次及以上，存在负权回路
</span><span style="color:#95a5a6"></span>                    <span style="color:#728e00">return</span> <span style="color:#728e00">false</span>;
                <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">in</span>[<span style="color:#434f54">v</span>]) {
                    <span style="color:#434f54">Q</span>.<span style="color:#434f54">push</span>(<span style="color:#434f54">v</span>), <span style="color:#434f54">in</span>[<span style="color:#434f54">v</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">true</span>;
                }
            }
        }
    }
    <span style="color:#728e00">return</span> <span style="color:#728e00">true</span>;
}
</code></pre></div><h2 id="dijkstra-算法">Dijkstra 算法 <a class="anchor" href="#dijkstra-%e7%ae%97%e6%b3%95">¶</a></h2><p>从节点 $s$ 出发.首先把所有节点分成两个集合：已确定最短路长度的，和未确定的.一开始只有 $s$ 在第一个集合，且 $dis[s] = 0,dis[$ 除 $s$ 以外的其他节点 $]=∞$.</p>
<p>重复以下操作直到第二个集合中没有节点：</p>
<ol>
<li>
<p>松弛刚加入第一个集合的节点的所有出边.</p>
</li>
<li>
<p>从第二个集合中，选取 $dis$ 值最小的节点，加入第一个集合.</p>
</li>
</ol>
<p>只能处理单源最短路径，不能处理负权路径.时间复杂度为 $O(n^2)$.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#728e00">const</span> <span style="color:#00979d">int</span> <span style="color:#434f54">N</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1e6</span>;
<span style="color:#00979d">int</span> <span style="color:#434f54">avl</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">dis</span>[<span style="color:#434f54">N</span>];

<span style="color:#00979d">void</span> <span style="color:#d35400">dijkstra</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">s</span>) {
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">avl</span>, <span style="color:#728e00">true</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">avl</span>);
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">dis</span>, <span style="color:#8a7b52">0x7f</span>, <span style="color:#728e00">sizeof</span> <span style="color:#434f54">dis</span>);
    <span style="color:#434f54">dis</span>[<span style="color:#434f54">s</span>] <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">minn</span> <span style="color:#728e00">=</span> <span style="color:#434f54">INF</span>, <span style="color:#434f54">minp</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">++</span>)
            <span style="color:#728e00">if</span>(<span style="color:#434f54">avl</span>[<span style="color:#434f54">j</span>] <span style="color:#728e00">&amp;&amp;</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">j</span>] <span style="color:#728e00">&lt;</span> <span style="color:#434f54">minn</span>)
                <span style="color:#434f54">minn</span> <span style="color:#728e00">=</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">j</span>], <span style="color:#434f54">minp</span> <span style="color:#728e00">=</span> <span style="color:#434f54">j</span>;
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">minp</span>) <span style="color:#728e00">continue</span>;
        <span style="color:#434f54">avl</span>[<span style="color:#434f54">minp</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">false</span>;
        <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">j</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">j</span> <span style="color:#728e00">++</span>)
            <span style="color:#728e00">if</span>(<span style="color:#434f54">avl</span>[<span style="color:#434f54">j</span>] <span style="color:#728e00">&amp;&amp;</span> <span style="color:#434f54">dis</span>[<span style="color:#434f54">j</span>] <span style="color:#728e00">&gt;</span> <span style="color:#434f54">minn</span> <span style="color:#728e00">+</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">minp</span>][<span style="color:#434f54">j</span>])
                <span style="color:#434f54">dis</span>[<span style="color:#434f54">j</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">minn</span> <span style="color:#728e00">+</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">minp</span>][<span style="color:#434f54">j</span>];
    }
}
</code></pre></div>
  </article>
</div>



  <div class="flex-right">
    <div class="outer">
      
  <div class="inner">
  <h2><img src="../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a></li>
    <li><a href="#松弛操作">松弛操作</a></li>
    <li><a href="#floyed-算法">Floyed 算法</a></li>
    <li><a href="#bellman-ford-算法">Bellman-Ford 算法</a>
      <ul>
        <li><a href="#判断负权回路">判断负权回路</a></li>
      </ul>
    </li>
    <li><a href="#spfa-算法">SPFA 算法</a>
      <ul>
        <li><a href="#判断负权回路-1">判断负权回路</a></li>
      </ul>
    </li>
    <li><a href="#dijkstra-算法">Dijkstra 算法</a></li>
  </ul>
</nav>
</div>



    </div>
  </div>

  <script src="../../../js/jquery.min.js"></script>


<script defer>
function IsPC() {  
  var userAgentInfo = navigator.userAgent;
  var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");  
  for (var v = 0; v < Agents.length; v ++) {  
    if (userAgentInfo.indexOf(Agents[v]) > 0) {
      return false;
    }
  }
  return true;
}
function detectZoom() {
  var ratio = 0,
  screen = window.screen,
  ua = navigator.userAgent.toLowerCase();
  if (window.devicePixelRatio !== undefined)
    ratio = window.devicePixelRatio;
  else if (~ua.indexOf('msie')) {
    if (screen.deviceXDPI && screen.logicalXDPI)
      ratio = screen.deviceXDPI / screen.logicalXDPI;
  }
  else if (window.outerWidth !== undefined && window.innerWidth !== undefined)
    ratio = window.outerWidth / window.innerWidth;
  
  if (ratio)
    ratio = Math.round(ratio * 100);
  return ratio;
}
$('img').each(function(id, el, arr) {
  if (el.parentElement.tagName == 'P') {
    el.className = "md__image";
    var src = el.getAttribute('src');
    if (IsPC() && src.substr(src.lastIndexOf(".") + 1) != "svg") {
      if (el.style.zoom)
        el.style.zoom = parseFloat(el.style.zoom) / detectZoom();
      else
        el.style.zoom = 100 / detectZoom();
    }
  }
});

















</script>





<link rel="stylesheet" href="../../../katex/katex.min.css">
<script src="../../../katex/katex.min.js"></script>
<script src="../../../katex/auto-render.min.js"></script>

<script>
  function renderTex() {
    renderMathInElement(document.body, {
      trust: true,
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ],
      macros: {
        
        "\\d": "\\text{d}",
        "\\zh": "\\footnotesize \\ ",
        "\\en": "\\normalsize \\ ",
        "\\su": "\\displaystyle",
        "\\eq": "\\Longleftrightarrow",
        "\\intro": "\\Longrightarrow",
        "\\mathring": "\\overset\{\\normalsizeₒ\}",
        "\\arccot": "\\text\{arccot\} \\, ",
        "\\xor": "\\text\{xor\} \\, ",
        "\\mex": "\\text\{mex\} \\, "
      }
    });
  }  
  document.addEventListener("DOMContentLoaded", function() {
    renderTex();
  });

</script>

<script>
  $('.language-latex').each(function(id, el, arr) {
    function toText(text) { 
      var temp = document.createElement("div"); 
      temp.innerHTML = text; 
      var output = temp.innerText || temp.textContent; 
      temp = null; 
      return output; 
    } 
    tex = toText(el.innerHTML);
    el.parentElement.outerHTML = '<div>$$' + tex + '$$</div>';
  });

</script>

<script>
  $('table').each(function(id, el, arr) {
    el.outerHTML = `<div class="md__table">${el.outerHTML}</div>`;
  });
</script>



<script src="../../../js/mermaid.min.js"></script>

<script>
  mermaid.initialize({
    
    themeCSS: ".node rect { \
      fill: transparent;    \
      stroke: transparent;  \
    }                       \
    .nodeLabel {            \
      font-size: 24px;      \
    }",
    startOnLoad: true,
    flowchart: {
      curve: 'cardinal'
    },
    securityLevel: 'loose',
  });
</script>

<script>
  Array.from(document.getElementsByClassName("language-mermaid")).forEach(
    (el) => {
      el.parentElement.outerHTML = `<div class="mermaid">${el.innerText}</div>`;
    }
  );
</script>

  
</main>
</body>
</html>