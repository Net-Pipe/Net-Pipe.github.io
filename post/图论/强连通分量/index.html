<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Net Pipe&#39;s Blog</title>  
  <meta name="description" content="简介 ¶强连通 ¶在有向图 $G$ 中，如果同时存在">
  <meta name="author" content="Net Pipe">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href='../../../index.xml' rel='alt' type='application/rss+xml' title='Net Pipe&#39;s Blog' />
  <link rel='shortcut icon' type='image/x-icon' href='../../../images/NetPipe.png' />

  
  <style>* {
  --aside-width: 18rem;
  --max-width: 75rem;
  --tag-color: rgb(10, 160, 190);
  --link-color: rgb(71, 148, 211);
  --hover-color: #F6F8FA;
  --border-color: #d0d7de;
  --shadow: 0 1px 0 1px rgba(0, 0, 0, .05);
  --border: 1px solid var(--border-color);
  --radius: .3rem; }

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  outline: none; }

::selection {
  background-color: #CCE2FF;
  color: rgba(0, 0, 0, 0.87); }

a {
  text-decoration: none;
  color: var(--link-color); }

a:focus, a:hover {
  outline: none;
  text-decoration: underline; }

a.alt, a.silent {
  color: black; }

a.alt:focus,
a.alt:hover,
a.alt:focus > *,
a.alt:hover > * {
  color: var(--link-color);
  text-decoration: underline; }

a.silent:focus,
a.silent:hover,
a.silent:focus > *,
a.silent:hover > * {
  color: black;
  text-decoration: none; }

ul, ol {
  list-style: circle;
  padding-left: 1rem; }
  ul li, ol li {
    margin: .3rem 0; }

@font-face {
  font-family: 'Fantasque Sans Mono';
  src: url("/fonts/FantasqueSansMono-Regular.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: normal;
  font-weight: bold;
  src: url("/fonts/FantasqueSansMono-Bold.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: italic;
  src: url("/fonts/FantasqueSansMono-Italic.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: italic;
  font-weight: bold;
  src: url("/fonts/FantasqueSansMono-BoldItalic.woff2") format("woff2"); }

body, code {
  font-family: 'Fantasque Sans Mono', sans-serif; }

html, body, main {
  height: 100%;
  overflow: hidden; }

body {
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  margin: 0 auto;
  max-width: var(--max-width);
  background-color: #f7f7f7; }

main {
  display: flex;
  position: relative;
  padding: .5rem; }

aside, section {
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  flex: 0 0 var(--aside-width);
  margin: .5rem;
  padding: 1rem;
  background-color: white;
  overflow: hidden auto; }
  aside > :first-child,
  aside > :first-child > :first-child,
  aside > :first-child > :first-child > :first-child, section > :first-child,
  section > :first-child > :first-child,
  section > :first-child > :first-child > :first-child {
    margin-top: 0; }
  aside > :last-child,
  aside > :last-child > :last-child,
  aside > :last-child > :last-child > :last-child, section > :last-child,
  section > :last-child > :last-child,
  section > :last-child > :last-child > :last-child {
    margin-bottom: 0; }

article {
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  flex-grow: 1;
  margin: .5rem;
  padding: 1rem;
  background-color: white;
  overflow: hidden auto; }
  article .post-toc {
    display: none; }

code {
  border-top: var(--border);
  border-bottom: var(--border);
  border-left: var(--border);
  border-right: var(--border);
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
  user-select: text;
  -moz-user-select: text;
  -webkit-user-select: text;
  padding: 1px 2px; }

.tag-card {
  display: inline-block;
  margin: .3rem 0;
  padding: .1rem .5rem;
  border-radius: var(--radius);
  background-color: var(--tag-color); }
  .tag-card a {
    font-size: 13px;
    text-shadow: 0 0;
    color: white; }
    .tag-card a:hover {
      color: white;
      text-decoration: none; }

.post-meta {
  color: gray; }
  .post-meta img {
    display: inline-block !important;
    vertical-align: text-bottom; }

#TableOfContents > ul {
  padding-left: 0; }
  #TableOfContents > ul li {
    list-style: none; }

.toc {
  position: absolute;
  display: block;
  top: 2rem;
  right: 2.5rem; }
  .toc img {
    border-top: var(--border);
    border-bottom: var(--border);
    border-left: var(--border);
    border-right: var(--border);
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
    border-bottom-left-radius: var(--radius);
    border-bottom-right-radius: var(--radius);
    width: 2.2rem;
    height: 2.2rem;
    float: right;
    background-color: white; }
    .toc img:hover {
      background-color: var(--hover-color); }
  .toc div.toc-content {
    border-top: var(--border);
    border-bottom: var(--border);
    border-left: var(--border);
    border-right: var(--border);
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
    border-bottom-left-radius: var(--radius);
    border-bottom-right-radius: var(--radius);
    display: none;
    margin-top: 3rem;
    padding: .5rem 1rem;
    background-color: white;
    overflow: auto;
    max-height: 100%; }
    .toc div.toc-content > :first-child,
    .toc div.toc-content > :first-child > :first-child,
    .toc div.toc-content > :first-child > :first-child > :first-child {
      margin-top: 0; }
    .toc div.toc-content > :last-child,
    .toc div.toc-content > :last-child > :last-child,
    .toc div.toc-content > :last-child > :last-child > :last-child {
      margin-bottom: 0; }

aside {
  text-align: center; }
  aside img.author {
    width: 6rem;
    height: 6rem;
    border-radius: 1rem; }
  aside h2.name {
    margin: .5rem; }
  aside .data {
    display: flex; }
    aside .data .data-box {
      flex: 0 0 50%;
      display: inline-block; }
      aside .data .data-box:first-of-type {
        border-right: 1px solid black; }
  aside .social {
    margin: 1rem 0;
    text-align: left; }
    aside .social .social-box {
      border-top: var(--border);
      border-bottom: var(--border);
      border-left: var(--border);
      border-right: var(--border);
      border-top-left-radius: var(--radius);
      border-top-right-radius: var(--radius);
      border-bottom-left-radius: var(--radius);
      border-bottom-right-radius: var(--radius);
      margin-top: .5rem;
      padding: .4rem;
      font-size: 18px; }
      aside .social .social-box:hover {
        background-color: var(--hover-color); }
      aside .social .social-box img {
        vertical-align: text-bottom;
        width: 20px;
        height: 20px;
        margin-right: .5rem; }
  aside .tags {
    text-align: left; }
    aside .tags h2 {
      margin: .5rem 0;
      font-size: 20px; }
      aside .tags h2 img {
        width: 20px;
        height: 20px;
        vertical-align: bottom;
        margin-right: 0.5rem; }

article.posts .post {
  border-top: var(--border);
  border-bottom: var(--border);
  border-left: var(--border);
  border-right: var(--border);
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
  margin: 1rem 0;
  padding: .5rem 1rem; }
  article.posts .post:hover {
    background-color: var(--hover-color); }
  article.posts .post .post-title {
    font-size: 20px; }

article.posts .pagination {
  width: 100%;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: center;
  font-size: 18px; }
  article.posts .pagination div.pagination-box {
    border-top: var(--border);
    border-bottom: var(--border);
    border-left: var(--border);
    border-right: var(--border);
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
    border-bottom-left-radius: var(--radius);
    border-bottom-right-radius: var(--radius);
    background-color: white;
    color: var(--link-color);
    margin: 0 .5rem;
    width: 2rem;
    height: 2rem;
    line-height: 2rem;
    float: left;
    text-align: center;
    vertical-align: middle;
    cursor: default; }
    article.posts .pagination div.pagination-box:not(.disabled):hover {
      background-color: var(--hover-color); }
  article.posts .pagination div.prev {
    width: 5rem;
    margin-left: 0; }
  article.posts .pagination div.next {
    width: 5rem;
    margin-right: 0; }
  article.posts .pagination div.pagination-eldivpsis {
    width: 3rem; }
  article.posts .pagination div.disabled {
    color: black; }

article.posts > :first-child,
article.posts > :first-child > :first-child,
article.posts > :first-child > :first-child > :first-child {
  margin-top: 0; }

article.posts > :last-child,
article.posts > :last-child > :last-child,
article.posts > :last-child > :last-child > :last-child {
  margin-bottom: 0; }

article.list .post-item {
  border-bottom: var(--border);
  border-left: var(--border);
  border-right: var(--border);
  height: 2.3rem;
  line-height: 2.3rem; }
  article.list .post-item:hover {
    background-color: var(--hover-color); }
  article.list .post-item img {
    width: 1.2rem;
    height: 1.2rem;
    margin-left: .6rem;
    vertical-align: sub; }
  article.list .post-item:first-of-type {
    border-top: var(--border);
    border-bottom: var(--border);
    border-left: var(--border);
    border-right: var(--border);
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
    height: 3rem;
    line-height: 3rem;
    font-size: 1.2rem;
    background-color: var(--hover-color); }
    article.list .post-item:first-of-type img {
      width: 1.4rem;
      height: 1.4rem; }
  article.list .post-item:last-of-type {
    border-bottom: var(--border);
    border-left: var(--border);
    border-right: var(--border);
    border-bottom-left-radius: var(--radius);
    border-bottom-right-radius: var(--radius); }

article.markdown h1, article.markdown h1 .katex {
  font-size: 28px; }

article.markdown h2, article.markdown h2 .katex {
  font-size: 24px; }

article.markdown h1, article.markdown h2, article.markdown h3, article.markdown h4, article.markdown h5, article.markdown h6 {
  margin: .5rem 0;
  font-weight: normal; }
  article.markdown h1 .anchor, article.markdown h2 .anchor, article.markdown h3 .anchor, article.markdown h4 .anchor, article.markdown h5 .anchor, article.markdown h6 .anchor {
    opacity: 0; }
  article.markdown h1:hover .anchor, article.markdown h1:focus .anchor, article.markdown h2:hover .anchor, article.markdown h2:focus .anchor, article.markdown h3:hover .anchor, article.markdown h3:focus .anchor, article.markdown h4:hover .anchor, article.markdown h4:focus .anchor, article.markdown h5:hover .anchor, article.markdown h5:focus .anchor, article.markdown h6:hover .anchor, article.markdown h6:focus .anchor {
    opacity: 1; }

article.markdown p {
  margin: .3rem 0; }

article.markdown strong {
  font-weight: normal;
  text-shadow: 0 0; }

article.markdown img:not(.alt) {
  display: block;
  margin: 0 auto;
  max-width: 100%; }

article.markdown blockquote {
  border-top: var(--border);
  border-bottom: var(--border);
  border-left: var(--border);
  border-right: var(--border);
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
  color: dimgray;
  margin: .5rem 0;
  padding: .5rem; }
  article.markdown blockquote > :first-child,
  article.markdown blockquote > :first-child > :first-child,
  article.markdown blockquote > :first-child > :first-child > :first-child {
    margin-top: 0; }
  article.markdown blockquote > :last-child,
  article.markdown blockquote > :last-child > :last-child,
  article.markdown blockquote > :last-child > :last-child > :last-child {
    margin-bottom: 0; }

article.markdown pre {
  border-top: var(--border);
  border-bottom: var(--border);
  border-left: var(--border);
  border-right: var(--border);
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
  user-select: text;
  -moz-user-select: text;
  -webkit-user-select: text;
  margin: .5rem 0;
  padding: .5rem;
  overflow: auto;
  line-height: 1.3rem; }
  article.markdown pre code {
    border: none;
    padding: 0; }

article.markdown table {
  display: block;
  margin: .5rem 0;
  overflow: auto;
  border-spacing: 0;
  -webkit-overflow-scrolling: touch; }
  article.markdown table tr:hover {
    background-color: var(--hover-color); }
  article.markdown table tr > :first-child {
    border-left: var(--border); }
  article.markdown table tr > :last-child {
    border-right: var(--border); }
  article.markdown table th, article.markdown table td {
    border-top: var(--border);
    padding: .3rem 16px;
    font-weight: normal;
    white-space: nowrap; }
  article.markdown table th:first-of-type {
    border-top-left-radius: var(--radius); }
  article.markdown table th:last-of-type {
    border-top-right-radius: var(--radius); }
  article.markdown table > :last-child > :last-child td {
    border-bottom: var(--border); }
    article.markdown table > :last-child > :last-child td:first-of-type {
      border-bottom-left-radius: var(--radius); }
    article.markdown table > :last-child > :last-child td:last-of-type {
      border-bottom-right-radius: var(--radius); }

article.markdown > :first-child,
article.markdown > :first-child > :first-child,
article.markdown > :first-child > :first-child > :first-child {
  margin-top: 0; }

article.markdown > :last-child,
article.markdown > :last-child > :last-child,
article.markdown > :last-child > :last-child > :last-child {
  margin-bottom: 0; }

@media screen and (max-width: 65rem) {
  section {
    display: none; }
  .post-toc {
    display: block !important; } }

@media screen and (max-width: 40rem) {
  main {
    display: block;
    overflow: auto; }
  aside, section {
    margin-bottom: 1rem; } }

.book-columns {
  display: flex;
  flex-wrap: wrap;
  margin: .5rem;
  margin-left: -.5rem;
  margin-right: -.5rem; }
  .book-columns .markdown-inner {
    margin: .5rem;
    flex: 1 1; }

.book-tabs {
  border-top: var(--border);
  border-bottom: var(--border);
  border-left: var(--border);
  border-right: var(--border);
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
  margin: .5em 0;
  overflow: hidden;
  display: flex;
  flex-wrap: wrap; }
  .book-tabs label {
    height: 1.5rem;
    line-height: 1.5rem;
    display: inline-block;
    padding: 0 .5rem;
    min-width: 2.5rem;
    cursor: pointer;
    z-index: 999;
    text-align: center; }
  .book-tabs .book-tabs-content {
    border-top: var(--border);
    border-bottom-left-radius: var(--radius);
    border-bottom-right-radius: var(--radius);
    border-top: var(--border);
    padding: .5rem;
    order: 999;
    width: 100%;
    display: none;
    overflow: hidden; }
    .book-tabs .book-tabs-content > :first-child,
    .book-tabs .book-tabs-content > :first-child > :first-child,
    .book-tabs .book-tabs-content > :first-child > :first-child > :first-child {
      margin-top: 0; }
    .book-tabs .book-tabs-content > :last-child,
    .book-tabs .book-tabs-content > :last-child > :last-child,
    .book-tabs .book-tabs-content > :last-child > :last-child > :last-child {
      margin-bottom: 0; }
  .book-tabs input[type="radio"] {
    display: none; }
    .book-tabs input[type="radio"]:not(:checked) + label {
      color: var(--border-color); }
      .book-tabs input[type="radio"]:not(:checked) + label:hover {
        background-color: var(--hover-color); }
    .book-tabs input[type="radio"]:checked + label {
      background-color: var(--hover-color); }
      .book-tabs input[type="radio"]:checked + label + .book-tabs-content {
        display: block; }

details {
  border-top: var(--border);
  border-bottom: var(--border);
  border-left: var(--border);
  border-right: var(--border);
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
  margin: .5rem 0;
  padding: .5rem; }
  details summary {
    font-size: 14px;
    text-shadow: 0 0; }
    details summary::marker {
      content: '';
      font-size: 0; }
    details summary img.alt {
      width: 18px;
      height: 18px;
      margin-right: .2rem;
      vertical-align: sub;
      transition: .2s all; }
  details ::-webkit-details-marker,
  details ::-moz-list-bullet {
    content: '';
    font-size: 0; }
  details[open] > summary {
    margin-bottom: 0; }
    details[open] > summary img.alt {
      transform: rotate(90deg); }
  details .markdown-inner {
    padding-top: .5rem; }
    details .markdown-inner > :first-child,
    details .markdown-inner > :first-child > :first-child,
    details .markdown-inner > :first-child > :first-child > :first-child {
      margin-top: 0; }
    details .markdown-inner > :last-child,
    details .markdown-inner > :last-child > :last-child,
    details .markdown-inner > :last-child > :last-child > :last-child {
      margin-bottom: 0; }
  details:focus {
    outline: none; }
</style>
  
</head>

<body>
  <main>
  <aside>
  <a href="../../../"><img class='author' src='../../../images/NetPipe.png'></a>
  <h2 class='name'>Net Pipe</h2>

  <div class="data">
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    <div class='data-box'>
      <h3>59</h3>
      <span>Posts</span>
    </div>
    <div class='data-box'>
      <h3>56327</h3>
      <span>Words</span>
    </div>
  </div>

  <div class="social">
    <a class="silent" href="../../../">
      <div class="social-box"><img src="../../../images/home.svg"/><span>Home</span></div>
    </a>
    <a class="silent" href="../../../post/">
      <div class="social-box"><img src="../../../images/posts.svg"/><span>Posts</span></div>
    </a>
    <a class="silent" type="application/rss+xml" href="../../../index.xml">
      <div class="social-box"><img src="../../../images/rss.svg"/><span>RSS</span></div>
    </a>
  </div>

  <div class="tags">
    <h2><img src="../../../images/categories.svg" />Tags</h2>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E5%9F%BA%E7%A1%80%E6%95%B0%E5%AD%A6/">基础数学</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/dp/">DP</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E4%BF%A1%E6%81%AF%E5%AD%A6/">信息学</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E6%95%B0%E8%AE%BA/">数论</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">组合数学</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E5%9B%BE%E8%AE%BA/">图论</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/">字符串</a>
    </div>
    
    <div class="tag-card">
      <a class="alt" href="../../../categories/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/">基础算法</a>
    </div>
    
  </div>
</aside>
  
<article class='markdown'>
<div class='content'>
  
  <h1>强连通分量</h1>
  
  <span class="post-meta">
    
    <img class='alt' src="../../../images/time.svg"></img>
    Jun 8, 2021
    
  </span>

  
  <div class='tag-card'>
    <a class='alt' href="../../../categories/%e4%bf%a1%e6%81%af%e5%ad%a6/">信息学</a>
  </div>
  
  <div class='tag-card'>
    <a class='alt' href="../../../categories/%e5%9b%be%e8%ae%ba/">图论</a>
  </div>
  

  
  <div class='post-toc'>
    <h2>TOC</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a>
      <ul>
        <li><a href="#强连通">强连通</a></li>
        <li><a href="#强连通图">强连通图</a></li>
        <li><a href="#强连通分量">强连通分量</a></li>
      </ul>
    </li>
    <li><a href="#tarjan-算法">Tarjan 算法</a>
      <ul>
        <li><a href="#图的结构">图的结构</a></li>
        <li><a href="#时间戳">时间戳</a></li>
        <li><a href="#追溯值">追溯值</a></li>
        <li><a href="#基本原理">基本原理</a></li>
      </ul>
    </li>
    <li><a href="#kosaraju-算法">Kosaraju 算法</a></li>
    <li><a href="#garbow-算法">Garbow 算法</a></li>
  </ul>
</nav>
    
  </div>

  <h2 id="简介">简介 <a class="anchor" href="#%e7%ae%80%e4%bb%8b">¶</a></h2><h3 id="强连通">强连通 <a class="anchor" href="#%e5%bc%ba%e8%bf%9e%e9%80%9a">¶</a></h3><p>在有向图 $G$ 中，如果同时存在 $u→v$ 和 $v→u$ 的路径，那么称 $u$ 和 $v$ 强连通.</p>
<p><img class="md__image" src="0.svg" alt=""  /></p>
<h3 id="强连通图">强连通图 <a class="anchor" href="#%e5%bc%ba%e8%bf%9e%e9%80%9a%e5%9b%be">¶</a></h3><p>如果有向图 $G$ 的任意两个节点都强连通，那么称 $G$ 是强连通图.</p>
<p><img class="md__image" src="1.svg" alt=""  /></p>
<h3 id="强连通分量">强连通分量 <a class="anchor" href="#%e5%bc%ba%e8%bf%9e%e9%80%9a%e5%88%86%e9%87%8f">¶</a></h3><p>如果图 $G$ 的子图是强连通图，那么该子图称作 $G$ 的强连通分量.</p>
<p><img class="md__image" src="2.svg" alt=""  /></p>
<p>本章介绍求强连通分量的三种算法.</p>
<h2 id="tarjan-算法">Tarjan 算法 <a class="anchor" href="#tarjan-%e7%ae%97%e6%b3%95">¶</a></h2><h3 id="图的结构">图的结构 <a class="anchor" href="#%e5%9b%be%e7%9a%84%e7%bb%93%e6%9e%84">¶</a></h3><p><code>Tarjan</code> 算法基于对图的 <a href="../../../docs/NOI/Basics/Search/dfs/">深度优先遍历（<code>DFS</code>）</a>，并且将图近似地看成一棵 <a href="../../../docs/NOI/Graph/Tree/">树</a>.因此，这棵树中会不可避免地出现一些奇怪的边.</p>
<p><img class="md__image" src="3.svg" alt=""  /></p>
<ul>
<li>
<p><font color=green>前向边</font>：与普通边方向一致，但跨越多个节点.</p>
</li>
<li>
<p><font color=red>返祖边</font>：与普通边方向相反，从子孙指向祖先.</p>
</li>
<li>
<p><font color=#4169e1>横向边</font>：边的两个端点居于树的同一深度.</p>
</li>
</ul>
<h3 id="时间戳">时间戳 <a class="anchor" href="#%e6%97%b6%e9%97%b4%e6%88%b3">¶</a></h3><p><code>DFS</code> 遍历一张图时，按访问顺序给节点打标记.$u$ 是第 $i$ 个被访问的节点，记作 $dfn[u]=i$.这个标记叫做「时间戳」.在图中，时间戳标记在节点的右上方.</p>
<p><img class="md__image" src="4.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center">$5$</td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$6$</td>
</tr>
</tbody>
</table>
<h3 id="追溯值">追溯值 <a class="anchor" href="#%e8%bf%bd%e6%ba%af%e5%80%bc">¶</a></h3><p><code>Tarjan</code> 算法还引入了「追溯值」：$low[u]$，定义为以下节点时间戳的最小值：</p>
<ul>
<li>
<p>以 $u$ 为根的子树中的所有节点.</p>
</li>
<li>
<p>从这棵子树的任意节点出发，经过 $1$ 条前向边、返祖边或横向边，能到达的节点.</p>
</li>
</ul>
<p>以 $low[2]$ 为例，其子树中有 $2,4,5$ 号节点，还可以通过一条返祖边到达 $1$ 号节点.$low[2]$ 为这些节点时间戳的最小值，也就是 $1$.</p>
<p><img class="md__image" src="5.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$5$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$6$</td>
</tr>
</tbody>
</table>
<h3 id="基本原理">基本原理 <a class="anchor" href="#%e5%9f%ba%e6%9c%ac%e5%8e%9f%e7%90%86">¶</a></h3><p><code>Tarjan</code> 算法是如何利用 $dfn$ 和 $low$ 来求强连通分量的呢？</p>
<ul>
<li>
<p>首先，强连通分量中必然存在环，也就必然存在返祖边.</p>
</li>
<li>
<p>如果节点 $u$ 满足 $dfn[u]=low[u]$，存在两种情况：</p>
<ul>
<li>
<p>如果 $u$ 没有出边，则 $u$ 独自为一个强连通分量.</p>
</li>
<li>
<p>否则 $u$ 的子树中必有一条返祖边指向 $u$ 本身，此处必存在多节点的强连通分量.</p>
</li>
</ul>
</li>
</ul>
<p>要想具体地确定哪些节点是强连通分量，还得借助 <a href="../../../docs/NOI/DS/stack/">栈</a>.具体看以下样例.</p>





<div class="book-tabs"><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-0" checked="checked" />
  <label for="tabs-%!s(int=1)-0">1</label>
  <div class="book-tabs-content"><p>$dfn[1]=low[1]=1$.
<img class="md__image" src="6.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-1"  />
  <label for="tabs-%!s(int=1)-1">2</label>
  <div class="book-tabs-content"><p>$dfn[2]=low[2]=1$.
<img class="md__image" src="7.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-2"  />
  <label for="tabs-%!s(int=1)-2">3</label>
  <div class="book-tabs-content"><p>$dfn[4]=low[4]=3$.节点 $4$ 有一条返祖边指向 $1$，故更新 $low[4]=low[1]=1$.
<img class="md__image" src="8.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-3"  />
  <label for="tabs-%!s(int=1)-3">4</label>
  <div class="book-tabs-content"><p>回溯至节点 $2$，更新 $low[2]=\min(low[2],low[4])=1$.
<img class="md__image" src="9.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-4"  />
  <label for="tabs-%!s(int=1)-4">5</label>
  <div class="book-tabs-content"><p>$dfn[5]=low[5]=4$.节点 $5$ 没有出边和子树，单独一个节点构成强连通分量.移除栈顶的 $5$.
<img class="md__image" src="10.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$\textcolor{red}{4}$</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$\textcolor{red}{4}$</td>
<td></td>
</tr>
</tbody>
</table>
</div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-5"  />
  <label for="tabs-%!s(int=1)-5">6</label>
  <div class="book-tabs-content"><p>回溯至节点 $2$，$low[2]=\min(low[2],low[5])=1$.
<img class="md__image" src="11.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
</tbody>
</table>
</div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-6"  />
  <label for="tabs-%!s(int=1)-6">7</label>
  <div class="book-tabs-content"><p>回溯至节点 $1$，$low[1]=\min(low[1],low[2])=1$.此时 $low[1]=dfn[1]$，栈顶的红色部分同属一个强连通分量.将其从栈中删除.
<img class="md__image" src="12.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
</tbody>
</table>
</div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-7"  />
  <label for="tabs-%!s(int=1)-7">&hellip;</label>
  <div class="book-tabs-content"></div></div>

<p>时间复杂度为 $O(n+m)$（$n$ 为点数，$m$ 为边数）.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#95a5a6">// ans: 强连通分量个数
</span><span style="color:#95a5a6"></span><span style="color:#728e00">const</span> <span style="color:#00979d">int</span> <span style="color:#434f54">N</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1e6</span>;
<span style="color:#00979d">int</span> <span style="color:#434f54">dfn</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">low</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">tot</span>, <span style="color:#434f54">ans</span>;
<span style="color:#00979d">int</span> <span style="color:#434f54">in</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// u 号节点在第 in[u] 个强连通分量
</span><span style="color:#95a5a6"></span><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// g[u]: u 指向的节点集合
</span><span style="color:#95a5a6"></span><span style="color:#434f54">stack</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">s</span>;

<span style="color:#00979d">void</span> <span style="color:#d35400">tarjan</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">dfn</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">++</span> <span style="color:#434f54">tot</span>;
    <span style="color:#434f54">s</span>.<span style="color:#434f54">push</span>(<span style="color:#434f54">u</span>);
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>];
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">dfn</span>[<span style="color:#434f54">v</span>]) {
            <span style="color:#434f54">tarjan</span>(<span style="color:#434f54">v</span>);
            <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>], <span style="color:#434f54">low</span>[<span style="color:#434f54">v</span>]);
        } <span style="color:#728e00">else</span> <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">in</span>[<span style="color:#434f54">u</span>])
            <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>], <span style="color:#434f54">dfn</span>[<span style="color:#434f54">v</span>]);
    }
    <span style="color:#728e00">if</span>(<span style="color:#434f54">dfn</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">==</span> <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>]) {
        <span style="color:#434f54">in</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">++</span> <span style="color:#434f54">ans</span>;
        <span style="color:#728e00">while</span>(<span style="color:#434f54">s</span>.<span style="color:#434f54">top</span>() <span style="color:#728e00">!=</span> <span style="color:#434f54">u</span>) <span style="color:#95a5a6">// 栈顶到 u 这部分的节点在同一个强连通分量
</span><span style="color:#95a5a6"></span>            <span style="color:#434f54">in</span>[<span style="color:#434f54">s</span>.<span style="color:#434f54">top</span>()] <span style="color:#728e00">=</span> <span style="color:#434f54">ans</span>, <span style="color:#434f54">s</span>.<span style="color:#434f54">pop</span>();
        <span style="color:#434f54">s</span>.<span style="color:#434f54">pop</span>();
    }
}
</code></pre></div><h2 id="kosaraju-算法">Kosaraju 算法 <a class="anchor" href="#kosaraju-%e7%ae%97%e6%b3%95">¶</a></h2><p><code>Kosaraju</code> 的核心思想可以总结为两点：</p>
<ul>
<li>
<p>强连通分量反过来还是强连通分量.</p>
</li>
<li>
<p>把强连通分量反一半过来会得到两条共起点、终点的路径.</p>
</li>
</ul>
<p>第一次正向遍历，第二次反向遍历，若出现共起点、终点的两条路径，则此处必有强连通分量.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#728e00">const</span> <span style="color:#00979d">int</span> <span style="color:#434f54">N</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1e6</span>;
<span style="color:#00979d">int</span> <span style="color:#434f54">sccCnt</span>, <span style="color:#434f54">color</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">vis</span>[<span style="color:#434f54">N</span>];
<span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">N</span>];  <span style="color:#95a5a6">// g[u]:  u 指向的节点集合
</span><span style="color:#95a5a6"></span><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g2</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// g2[u]: 指向 u 的节点集合（反图）
</span><span style="color:#95a5a6"></span><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">s</span>;

<span style="color:#00979d">void</span> <span style="color:#d35400">dfs1</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">vis</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">true</span>;
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>];
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">vis</span>[<span style="color:#434f54">v</span>]) <span style="color:#434f54">dfs1</span>(<span style="color:#434f54">v</span>);
    }
    <span style="color:#434f54">s</span>.<span style="color:#434f54">push_back</span>(<span style="color:#434f54">u</span>);
}

<span style="color:#00979d">void</span> <span style="color:#d35400">dfs2</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">color</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">sccCnt</span>;
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">g2</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g2</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>];
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">color</span>[<span style="color:#434f54">v</span>]) <span style="color:#434f54">dfs2</span>(<span style="color:#434f54">v</span>);
    }
}

<span style="color:#00979d">void</span> <span style="color:#d35400">kosaraju</span>() {
    <span style="color:#434f54">sccCnt</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>)
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">vis</span>[<span style="color:#434f54">i</span>]) <span style="color:#434f54">dfs1</span>(<span style="color:#434f54">i</span>);
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&gt;=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">--</span>) {
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">color</span>[<span style="color:#434f54">s</span>[<span style="color:#434f54">i</span>]]) {
            <span style="color:#728e00">++</span> <span style="color:#434f54">sccCnt</span>;
            <span style="color:#434f54">dfs2</span>(<span style="color:#434f54">s</span>[<span style="color:#434f54">i</span>]);
        }
    }
}
</code></pre></div><h2 id="garbow-算法">Garbow 算法 <a class="anchor" href="#garbow-%e7%ae%97%e6%b3%95">¶</a></h2><blockquote class="book-hint warning">
<p>未完待续 $\cdots \ \cdots$</p>
</blockquote>

<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00979d">int</span> <span style="color:#d35400">garbow</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">stack1</span>[<span style="color:#728e00">++</span><span style="color:#434f54">p1</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">u</span>;
    <span style="color:#434f54">stack2</span>[<span style="color:#728e00">++</span><span style="color:#434f54">p2</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">u</span>;
    <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">++</span><span style="color:#434f54">dfs_clock</span>;
    <span style="color:#728e00">for</span> (<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#434f54">head</span>[<span style="color:#434f54">u</span>]; <span style="color:#434f54">i</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#434f54">e</span>[<span style="color:#434f54">i</span>].<span style="color:#434f54">next</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">e</span>[<span style="color:#434f54">i</span>].<span style="color:#434f54">to</span>;
        <span style="color:#728e00">if</span> (<span style="color:#728e00">!</span><span style="color:#434f54">low</span>[<span style="color:#434f54">v</span>])
            <span style="color:#434f54">garbow</span>(<span style="color:#434f54">v</span>);
        <span style="color:#728e00">else</span> <span style="color:#728e00">if</span> (<span style="color:#728e00">!</span><span style="color:#434f54">sccno</span>[<span style="color:#434f54">v</span>])
            <span style="color:#728e00">while</span> (<span style="color:#434f54">low</span>[<span style="color:#434f54">stack2</span>[<span style="color:#434f54">p2</span>]] <span style="color:#728e00">&gt;</span> <span style="color:#434f54">low</span>[<span style="color:#434f54">v</span>]) <span style="color:#434f54">p2</span><span style="color:#728e00">--</span>;
    }
    <span style="color:#728e00">if</span> (<span style="color:#434f54">stack2</span>[<span style="color:#434f54">p2</span>] <span style="color:#728e00">==</span> <span style="color:#434f54">u</span>) {
        <span style="color:#434f54">p2</span><span style="color:#728e00">--</span>;
        <span style="color:#434f54">scc_cnt</span><span style="color:#728e00">++</span>;
        <span style="color:#728e00">do</span> {
            <span style="color:#434f54">sccno</span>[<span style="color:#434f54">stack1</span>[<span style="color:#434f54">p1</span>]] <span style="color:#728e00">=</span> <span style="color:#434f54">scc_cnt</span>;
        } <span style="color:#728e00">while</span> (<span style="color:#434f54">stack1</span>[<span style="color:#434f54">p1</span><span style="color:#728e00">--</span>] <span style="color:#728e00">!=</span> <span style="color:#434f54">u</span>);
    }
    <span style="color:#728e00">return</span> <span style="color:#8a7b52">0</span>;
}

<span style="color:#00979d">void</span> <span style="color:#d35400">find_scc</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">n</span>) {
    <span style="color:#434f54">dfs_clock</span> <span style="color:#728e00">=</span> <span style="color:#434f54">scc_cnt</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#434f54">p1</span> <span style="color:#728e00">=</span> <span style="color:#434f54">p2</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">sccno</span>, <span style="color:#8a7b52">0</span>, <span style="color:#728e00">sizeof</span>(<span style="color:#434f54">sccno</span>));
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">low</span>, <span style="color:#8a7b52">0</span>, <span style="color:#728e00">sizeof</span>(<span style="color:#434f54">low</span>));
    <span style="color:#728e00">for</span> (<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span><span style="color:#728e00">++</span>)
        <span style="color:#728e00">if</span> (<span style="color:#728e00">!</span><span style="color:#434f54">low</span>[<span style="color:#434f54">i</span>]) <span style="color:#434f54">garbow</span>(<span style="color:#434f54">i</span>);
}
</code></pre></div>
  
</div>

</article>

  
<section>
  
  <h2>TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a>
      <ul>
        <li><a href="#强连通">强连通</a></li>
        <li><a href="#强连通图">强连通图</a></li>
        <li><a href="#强连通分量">强连通分量</a></li>
      </ul>
    </li>
    <li><a href="#tarjan-算法">Tarjan 算法</a>
      <ul>
        <li><a href="#图的结构">图的结构</a></li>
        <li><a href="#时间戳">时间戳</a></li>
        <li><a href="#追溯值">追溯值</a></li>
        <li><a href="#基本原理">基本原理</a></li>
      </ul>
    </li>
    <li><a href="#kosaraju-算法">Kosaraju 算法</a></li>
    <li><a href="#garbow-算法">Garbow 算法</a></li>
  </ul>
</nav>
  
</section>

  </main>

  <script src="../../../js/jquery.min.js"></script>



<script defer>
function IsPC() {  
  var userAgentInfo = navigator.userAgent;
  var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");  
  for (var v = 0; v < Agents.length; v ++) {  
    if (userAgentInfo.indexOf(Agents[v]) > 0) {
      return false;
    }
  }
  return true;
}
function detectZoom() {
  var ratio = 0,
  screen = window.screen,
  ua = navigator.userAgent.toLowerCase();
  if (window.devicePixelRatio !== undefined)
    ratio = window.devicePixelRatio;
  else if (~ua.indexOf('msie')) {
    if (screen.deviceXDPI && screen.logicalXDPI)
      ratio = screen.deviceXDPI / screen.logicalXDPI;
  }
  else if (window.outerWidth !== undefined && window.innerWidth !== undefined)
    ratio = window.outerWidth / window.innerWidth;
  
  if (ratio)
    ratio = Math.round(ratio * 100);
  return ratio;
}
$('.markdown').find('img').each(function(id, el, arr) {
  if (el.className == 'alt')
    return;
  el.className = "md__image";
  var src = el.getAttribute('src');
  if (IsPC()) {
    if (el.style.zoom)
      el.style.zoom = parseFloat(el.style.zoom) / detectZoom();
    else
      el.style.zoom = 100 / detectZoom();
  }
});
</script>



<link rel="stylesheet" href="../../../katex/katex.min.css">
<script src="../../../katex/katex.min.js"></script>
<script src="../../../katex/auto-render.min.js"></script>

<script>
function renderTex() {
  renderMathInElement(document.body, {
    trust: true,
    delimiters: [
      { left: "$$", right: "$$", display: true },
      { left: "$", right: "$", display: false }
    ],
    macros: {
      
      "\\d": "\\text{d}",
      "\\zh": "\\footnotesize \\ ",
      "\\en": "\\normalsize \\ ",
      "\\su": "\\displaystyle",
      "\\eq": "\\Longleftrightarrow",
      "\\intro": "\\Longrightarrow",
      "\\mathring": "\\overset\{\\normalsizeₒ\}",
      "\\arccot": "\\text\{arccot\} \\, ",
      "\\xor": "\\text\{xor\} \\, ",
      "\\mex": "\\text\{mex\} \\, "
    }
  });
}  
document.addEventListener("DOMContentLoaded", function() {
  renderTex();
});
$('.language-latex').each(function(id, el, arr) {
  function toText(text) { 
    var temp = document.createElement("div"); 
    temp.innerHTML = text; 
    var output = temp.innerText || temp.textContent; 
    temp = null; 
    return output; 
  } 
  tex = toText(el.innerHTML);
  el.parentElement.outerHTML = '<div>$$' + tex + '$$</div>';
});
</script>


<script>
$(window).scroll(function(e) {
  if ($('main').css('display') == 'flex')
    $(this).scrollTop(0);
});
$('main').scroll(function(e) {
  if ($('main').css('display') == 'flex')
    $(this).scrollTop(0);
});
document.body.scroll="no";
</script>
</body>

</html>